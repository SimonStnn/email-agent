{"timestamp": "2025-11-26T13:23:57.540531+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Previous logs archived: 3 file(s) \u2192 archives/20251126_132357", "module": "logging_config", "function": "setup_logging", "line": 215}
{"timestamp": "2025-11-26T13:23:57.540624+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Logging initialized - Level: INFO", "module": "logging_config", "function": "setup_logging", "line": 222}
{"timestamp": "2025-11-26T13:23:57.540689+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Log directory: /workspaces/email-agent/m365-mcp/logs", "module": "logging_config", "function": "setup_logging", "line": 223}
{"timestamp": "2025-11-26T13:23:57.540726+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "All logs: mcp_server_all.jsonl", "module": "logging_config", "function": "setup_logging", "line": 224}
{"timestamp": "2025-11-26T13:23:57.540760+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Error logs: mcp_server_errors.jsonl", "module": "logging_config", "function": "setup_logging", "line": 225}
{"timestamp": "2025-11-26T13:23:57.540791+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Readable logs: mcp_server.log", "module": "logging_config", "function": "setup_logging", "line": 226}
{"timestamp": "2025-11-26T13:23:57.541248+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "================================================================================", "module": "server", "function": "_log_startup_info", "line": 53}
{"timestamp": "2025-11-26T13:23:57.541291+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "M365 MCP Server Starting v0.2.3", "module": "server", "function": "_log_startup_info", "line": 54}
{"timestamp": "2025-11-26T13:23:57.541323+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "================================================================================", "module": "server", "function": "_log_startup_info", "line": 55}
{"timestamp": "2025-11-26T13:23:57.541354+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "PID: 1490547", "module": "server", "function": "_log_startup_info", "line": 56}
{"timestamp": "2025-11-26T13:23:57.541384+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Python: 3.12.11 (main, Jul  1 2025, 05:28:02) [GCC 10.2.1 20210110]", "module": "server", "function": "_log_startup_info", "line": 57}
{"timestamp": "2025-11-26T13:23:57.541416+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Working Directory: /workspaces/email-agent/m365-mcp", "module": "server", "function": "_log_startup_info", "line": 58}
{"timestamp": "2025-11-26T13:23:57.541446+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Environment Variables:", "module": "server", "function": "_log_startup_info", "line": 59}
{"timestamp": "2025-11-26T13:23:57.541479+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  M365_MCP_CLIENT_ID: 0e0cad2c...b86f", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-26T13:23:57.541511+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_TRANSPORT: http", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-26T13:23:57.541541+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_HOST: 0.0.0.0", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-26T13:23:57.541571+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_PORT: 8400", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-26T13:23:57.541600+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_AUTH_METHOD: none", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-26T13:23:57.541628+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "================================================================================", "module": "server", "function": "_log_startup_info", "line": 72}
{"timestamp": "2025-11-26T13:23:57.541668+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Transport mode: http", "module": "server", "function": "main", "line": 126}
{"timestamp": "2025-11-26T13:23:57.541704+00:00", "level": "WARNING", "logger": "m365_mcp.server", "message": "Binding to all network interfaces (0.0.0.0) - ensure firewall is configured!", "module": "server", "function": "main", "line": 135}
{"timestamp": "2025-11-26T13:23:57.541740+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Authentication method: none", "module": "server", "function": "main", "line": 145}
{"timestamp": "2025-11-26T13:23:57.541770+00:00", "level": "WARNING", "logger": "m365_mcp.server", "message": "Running HTTP server without authentication!", "module": "server", "function": "main", "line": 148}
{"timestamp": "2025-11-26T13:23:57.541805+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Starting HTTP transport on 0.0.0.0:8400/mcp", "module": "server", "function": "main", "line": 173}
{"timestamp": "2025-11-26T13:23:57.541837+00:00", "level": "WARNING", "logger": "m365_mcp.server", "message": "Running in insecure mode (no authentication)", "module": "server", "function": "main", "line": 187}
{"timestamp": "2025-11-26T13:23:57.543758+00:00", "level": "DEBUG", "logger": "asyncio", "message": "Using selector: EpollSelector", "module": "selector_events", "function": "__init__", "line": 64}
{"timestamp": "2025-11-26T13:23:57.553036+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "StreamableHTTP session manager started", "module": "streamable_http_manager", "function": "run", "line": 110}
{"timestamp": "2025-11-26T13:28:41.123500+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:28:41.123710+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: dd1b54f000984730a990551c27f38f16", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:28:41.125820+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:28:41.125927+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:28:41.126103+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:28:41.127552+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:28:41.127894+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:28:41.128394+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:28:41.128876+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:28:41.129290+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b8c1b770>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:28:41.129360+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:28:41.129427+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:28:41.130083+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:28:41.130511+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:28:41.131036+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:28:41.131436+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:28:41.134689+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:28:41.134736+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: dd1b54f000984730a990551c27f38f16", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:28:41.134950+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:28:41.135155+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:29:06.542915+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:29:06.543031+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: f2ad5b59402149a7b653881fb769ffb5", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:29:06.544805+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:29:06.544857+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:29:06.544998+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:29:06.546221+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:29:06.546517+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:29:06.546871+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:29:06.547977+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:29:06.548361+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:29:06.548417+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:29:06.548469+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:29:06.548958+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:29:06.549337+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:29:06.549758+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:29:06.550109+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:29:06.553777+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:29:06.553812+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: f2ad5b59402149a7b653881fb769ffb5", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:29:06.554005+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:29:06.554185+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:33:18.744841+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:33:18.744959+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: 4a3602ffa0a7464c8741a27e3c6cd369", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:33:18.746648+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:33:18.746698+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:33:18.746831+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:33:18.748251+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:18.748599+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:18.748906+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:33:18.749667+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:18.750034+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:33:18.750088+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:33:18.750139+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:33:18.750619+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:33:18.751002+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:33:18.751457+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:33:18.751933+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:33:18.754989+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:18.755025+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: 4a3602ffa0a7464c8741a27e3c6cd369", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:33:18.755213+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:33:18.755407+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:33:31.689063+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:33:31.689174+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: a90f96a869f44d2ea805a21d7c11de70", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:33:31.690910+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:33:31.690964+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:33:31.691102+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:33:31.692430+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:31.692734+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:31.693072+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:33:31.694185+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:31.694561+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:33:31.694619+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:33:31.694677+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:33:31.695166+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:33:31.695552+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:33:31.696126+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:33:31.696501+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:33:31.700329+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:33:31.700362+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: a90f96a869f44d2ea805a21d7c11de70", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:33:31.700549+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:33:31.700742+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:39:02.200569+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:39:02.200691+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: f1e8e754c1934ba0b7440cfdbed730d4", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:39:02.202462+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:39:02.202514+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:39:02.202640+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:39:02.204106+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:02.204427+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:02.204712+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:39:02.205395+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:02.205760+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:39:02.205816+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:39:02.205865+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:39:02.206334+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:39:02.206738+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:39:02.207242+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:39:02.207747+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:39:02.210705+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:02.210743+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: f1e8e754c1934ba0b7440cfdbed730d4", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:39:02.210932+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:39:02.211119+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:39:23.422658+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:39:23.422766+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: baf63dea968542dcab6964e50d2af51c", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:39:23.424451+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:39:23.424501+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:39:23.424630+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:39:23.426119+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:23.426423+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:23.426743+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:39:23.427510+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:23.427853+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b8c738f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:39:23.427907+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:39:23.427958+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:39:23.428449+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:39:23.428824+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:39:23.429313+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:39:23.429706+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:39:23.433541+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:39:23.433574+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: baf63dea968542dcab6964e50d2af51c", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:39:23.433758+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:39:23.433938+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:46:48.073529+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:46:48.073651+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: d7f21cff16ab422180697a63053c54fd", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:46:48.075481+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:46:48.075559+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:46:48.075766+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:46:48.077465+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:46:48.078000+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:46:48.078471+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:46:48.079383+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:46:48.079847+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:46:48.079946+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:46:48.080020+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:46:48.080517+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:46:48.080913+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:46:48.081426+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:46:48.081975+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:46:48.085185+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:46:48.085237+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: d7f21cff16ab422180697a63053c54fd", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:46:48.085479+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:46:48.085800+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:49:33.775435+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:49:33.775546+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: 82c6085848714d22926a0471ebe32046", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:49:33.777285+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:49:33.777336+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:49:33.777467+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:49:33.778940+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:33.779236+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:33.779553+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:49:33.780310+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:33.780678+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:49:33.780735+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:49:33.780785+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:49:33.781258+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:49:33.781635+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:49:33.782164+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:49:33.782554+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:49:33.785622+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:33.785658+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: 82c6085848714d22926a0471ebe32046", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T13:49:33.785840+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T13:49:33.786021+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:49:40.883623+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T13:49:40.883788+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: ad051fafbd394274bd391a9ab1900d4f", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T13:49:40.885705+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:49:40.885796+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:49:40.885985+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:49:40.888293+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:40.888831+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:40.889248+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:49:40.891810+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:49:40.892275+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:49:40.892363+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:49:40.892441+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:49:40.892938+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:49:40.893344+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:49:40.893855+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:49:40.894296+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:49:55.889573+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:49:55.889484+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:50:10.889946+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:50:10.889852+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:50:25.890388+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:50:25.890320+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:50:40.890793+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:50:40.890711+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:50:55.891240+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:50:55.891170+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:51:10.891892+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:51:10.891807+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:51:25.892707+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:51:25.892622+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:51:40.893780+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:51:40.893708+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:51:55.894962+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:51:55.894891+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:52:10.896115+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:52:10.896047+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:52:25.896539+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:52:25.896443+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:52:40.897451+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:52:40.897355+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:52:55.898246+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:52:55.898175+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:52:59.690905+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:52:59.691529+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b8c1a960>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:52:59.691593+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type CallToolRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:52:59.691693+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type CallToolRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:52:59.718774+00:00", "level": "DEBUG", "logger": "keyring.backend", "message": "Loading KWallet", "module": "backend", "function": "_load_plugins", "line": 243}
{"timestamp": "2025-11-26T13:52:59.719636+00:00", "level": "DEBUG", "logger": "keyring.backend", "message": "Loading SecretService", "module": "backend", "function": "_load_plugins", "line": 243}
{"timestamp": "2025-11-26T13:52:59.732414+00:00", "level": "DEBUG", "logger": "keyring.backend", "message": "Loading Windows", "module": "backend", "function": "_load_plugins", "line": 243}
{"timestamp": "2025-11-26T13:52:59.733268+00:00", "level": "DEBUG", "logger": "keyring.backend", "message": "Loading chainer", "module": "backend", "function": "_load_plugins", "line": 243}
{"timestamp": "2025-11-26T13:52:59.733678+00:00", "level": "DEBUG", "logger": "keyring.backend", "message": "Loading libsecret", "module": "backend", "function": "_load_plugins", "line": 243}
{"timestamp": "2025-11-26T13:52:59.734421+00:00", "level": "DEBUG", "logger": "keyring.backend", "message": "Loading macOS", "module": "backend", "function": "_load_plugins", "line": 243}
{"timestamp": "2025-11-26T13:52:59.782742+00:00", "level": "WARNING", "logger": "m365_mcp.encryption", "message": "System keyring unavailable: No recommended backend was available. Install a recommended 3rd party backend package; or, install the keyrings.alt package if you want to use the non-recommended backends. See https://pypi.org/project/keyring for details.", "module": "encryption", "function": "_get_key_from_keyring", "line": 158}
{"timestamp": "2025-11-26T13:52:59.782819+00:00", "level": "INFO", "logger": "m365_mcp.encryption", "message": "No existing encryption key found, generating new key", "module": "encryption", "function": "get_or_create_key", "line": 114}
{"timestamp": "2025-11-26T13:52:59.782865+00:00", "level": "DEBUG", "logger": "m365_mcp.encryption", "message": "Generated new 256-bit encryption key", "module": "encryption", "function": "generate_key", "line": 67}
{"timestamp": "2025-11-26T13:52:59.782893+00:00", "level": "WARNING", "logger": "m365_mcp.encryption", "message": "Could not store key in keyring: No recommended backend was available. Install a recommended 3rd party backend package; or, install the keyrings.alt package if you want to use the non-recommended backends. See https://pypi.org/project/keyring for details.", "module": "encryption", "function": "_store_key_in_keyring", "line": 209}
{"timestamp": "2025-11-26T13:52:59.782928+00:00", "level": "WARNING", "logger": "m365_mcp.encryption", "message": "New encryption key generated but could not be stored in keyring. To persist the key across sessions, set the M365_MCP_CACHE_KEY environment variable.", "module": "encryption", "function": "get_or_create_key", "line": 121}
{"timestamp": "2025-11-26T13:52:59.782960+00:00", "level": "INFO", "logger": "m365_mcp.cache", "message": "Cache encryption enabled", "module": "cache", "function": "__init__", "line": 69}
{"timestamp": "2025-11-26T13:52:59.892375+00:00", "level": "INFO", "logger": "m365_mcp.cache", "message": "Database schema initialized", "module": "cache", "function": "_init_database", "line": 147}
{"timestamp": "2025-11-26T13:52:59.892448+00:00", "level": "INFO", "logger": "m365_mcp.cache", "message": "Cache manager initialized at /root/.m365_mcp_cache.db", "module": "cache", "function": "__init__", "line": 75}
{"timestamp": "2025-11-26T13:52:59.922705+00:00", "level": "DEBUG", "logger": "urllib3.util.retry", "message": "Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)", "module": "retry", "function": "from_int", "line": 286}
{"timestamp": "2025-11-26T13:52:59.922787+00:00", "level": "DEBUG", "logger": "msal.authority", "message": "Initializing with Entra authority: https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802", "module": "authority", "function": "__init__", "line": 75}
{"timestamp": "2025-11-26T13:52:59.923964+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "Starting new HTTPS connection (1): login.microsoftonline.com:443", "module": "connectionpool", "function": "_new_conn", "line": 1049}
{"timestamp": "2025-11-26T13:53:00.058631+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"GET /503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0/.well-known/openid-configuration HTTP/1.1\" 200 1964", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:00.059163+00:00", "level": "DEBUG", "logger": "msal.authority", "message": "openid_config(\"https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic', 'self_signed_tls_client_auth'], 'jwks_uri': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/kerberos', 'mtls_endpoint_aliases': {'token_endpoint': 'https://mtlsauth.microsoft.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token'}, 'tls_client_certificate_bound_access_tokens': True, 'tenant_region_scope': 'EU', 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}", "module": "authority", "function": "__init__", "line": 96}
{"timestamp": "2025-11-26T13:53:00.059302+00:00", "level": "DEBUG", "logger": "msal.application", "message": "Broker enabled? None", "module": "application", "function": "_decide_broker", "line": 718}
{"timestamp": "2025-11-26T13:53:00.167862+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/devicecode HTTP/1.1\" 200 473", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:00.168191+00:00", "level": "DEBUG", "logger": "msal.telemetry", "message": "Generate or reuse correlation_id: 72c884d2-b41a-4bdc-b093-627e0f9b0bc4", "module": "telemetry", "function": "__init__", "line": 37}
{"timestamp": "2025-11-26T13:53:00.240103+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:05.427913+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:10.490695+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:15.609410+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:20.675488+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:26.192891+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:31.274480+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:36.355227+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:41.529460+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:46.610883+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:51.703665+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:53:56.854243+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:01.939569+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:07.002428+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:12.071266+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:17.168773+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:22.241474+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:27.307498+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:32.390217+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:37.651363+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:42.822048+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 200 5380", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:54:42.822470+00:00", "level": "DEBUG", "logger": "msal.token_cache", "message": "event={\n    \"client_id\": \"0e0cad2c-a7d7-485d-9604-59e172bcb86f\",\n    \"data\": {\n        \"claims\": null,\n        \"client_id\": \"0e0cad2c-a7d7-485d-9604-59e172bcb86f\",\n        \"code\": \"GAQABIQEAAABlMNzVhAPUTrARzfQjWPtK2-HvBnI7lzqzP5QnOg1EZv_f1Zszg6Gp1T78UukAJiCbdnfZnhP5ti3LY5LzLdnoEgYmUCIg0bAPK5tMdPTfcQe_xO5Mtp0Z7K5EA3tDiqKre7s3WSuIMNu-idgmAAYrMYOWZ0EFZkYlqZVZFwyWwKT87tlI0rhR3o69Dbbsb2AgAA\",\n        \"device_code\": \"GAQABIQEAAABlMNzVhAPUTrARzfQjWPtK2-HvBnI7lzqzP5QnOg1EZv_f1Zszg6Gp1T78UukAJiCbdnfZnhP5ti3LY5LzLdnoEgYmUCIg0bAPK5tMdPTfcQe_xO5Mtp0Z7K5EA3tDiqKre7s3WSuIMNu-idgmAAYrMYOWZ0EFZkYlqZVZFwyWwKT87tlI0rhR3o69Dbbsb2AgAA\"\n    },\n    \"environment\": \"login.microsoftonline.com\",\n    \"grant_type\": \"urn:ietf:params:oauth:grant-type:device_code\",\n    \"params\": null,\n    \"response\": {\n        \"access_token\": \"********\",\n        \"client_info\": \"eyJ1aWQiOiIwMzgwYzFlNy1jY2FmLTQ4ODYtYmJjYy00NGZhZjhlZjM0ZDMiLCJ1dGlkIjoiNTAzMjUzYzEtZDA0Ny00ZDU1LWE1ZTctZWI2YjBmYzM0ODAyIn0\",\n        \"expires_in\": 5351,\n        \"ext_expires_in\": 5351,\n        \"id_token\": \"********\",\n        \"refresh_token\": \"********\",\n        \"scope\": \"Mail.Read Mail.ReadWrite Mail.Send openid profile User.Read email\",\n        \"token_type\": \"Bearer\"\n    },\n    \"scope\": [\n        \"Mail.Read\",\n        \"Mail.ReadWrite\",\n        \"Mail.Send\",\n        \"openid\",\n        \"profile\",\n        \"User.Read\",\n        \"email\"\n    ],\n    \"token_endpoint\": \"https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token\"\n}", "module": "token_cache", "function": "add", "line": 210}
{"timestamp": "2025-11-26T13:54:43.326419+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T13:54:43.326589+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:54:43.326552+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:54:43.326637+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:54:43.326614+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:54:43.326839+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T13:54:43.327037+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":2,\"result\":{\"content\":[{\"type\":\"text\",\"text\":\"[{\\\\\"@odata.etag\\\\\":\\\\\"W/\\\\\\\\\\\\\"CQAAABYAAADLCf2e1u4cTqSwX4ueiKN3AAA/aAFp\\\\\\\\\\\\\"\\\\\",\\\\\"id\\\\\":\\\\\"AAMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgBGAAAAAACwtNzdyw3yQpjTu3qPaUVNBwDLCf2e1u4cTqSwX4ueiKN3AAAAAAEMAADLCf2e1u4cTqSwX4ueiKN3AAA-gl7zAAA=\\\\\",\\\\\"receivedDateTime\\\\\":\\\\\"2025-08-28T15:22:04Z\\\\\",\\\\\"hasAttachments\\\\\":false,\\\\\"subject\\\\\":\\\\\"FW: Inventory Reorder Automation\\\\\",\\\\\"conversationId\\\\\":\\\\\"AAQkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgAQAJBSqYLPJShDiGuicb-XMo8=\\\\\",\\\\\"isRead\\\\\":true,\\\\\"body\\\\\":{\\\\\"contentType\\\\\":\\\\\"text\\\\\",\\\\\"content\\\\\":\\\\\"Hi Simon,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nWe have a question about our CERM system, please see below what my colleagues need.\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nThank you,\\\\\\\\r\\\\\\\\nPeter Heyse\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n[CERM]<https://www.cerm.net/>\\\\\\\\r\\\\\\\\nPeter\\\\\\\\r\\\\\\\\nHeyse   \\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\\\\\\\r\\\\\\\\nDirector of Product Management\\\\\\\\r\\\\\\\\npeter.heyse@cerm.net<mailto:peter.heyse@cerm.net>\\\\\\\\r\\\\\\\\n+32 (0)495 56 29 32<tel:+32%20(0)495%2056%2029%2032>\\\\\\\\r\\\\\\\\n[cid:image911450.png@BF25339E.CC63810A]<https://www.facebook.com/cermmis>\\\\\\\\r\\\\\\\\n[cid:image050711.png@734C55C8.D05C30E2]<https://www.linkedin.com/company/cerm>\\\\\\\\r\\\\\\\\n[cid:image689168.png@A083C1C3.3A498EF4]<https://www.cerm.net/>\\\\\\\\r\\\\\\\\n[Visit us at Labelexpo! Booth #3G43]<https://www.cerm.net/events/labelexpo-europe-2025>\\\\\\\\r\\\\\\\\nFrom: Peter Heyse <peter.heyse@gmail.com>\\\\\\\\r\\\\\\\\nSent: donderdag 28 augustus 2025 15:06\\\\\\\\r\\\\\\\\nTo: Peter Heyse <peter.heyse@cerm.net>\\\\\\\\r\\\\\\\\nSubject: Inventory Reorder Automation\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Peter Claes (Warehouse Clerk)\\\\\\\\r\\\\\\\\nTo: Sofie Lenaerts (Inventory Manager)\\\\\\\\r\\\\\\\\nSubject: Running out of raw materials again\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nHi Sofie,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nWe had another case this morning \\xe2\\x80\\x94 production stopped for 2 hours because we didn\\xe2\\x80\\x99t have enough raw plastic. I checked in ERP and saw the minimum stock level was already reached last Friday. No purchase order was created automatically.\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nAm I doing something wrong when checking the reorder settings?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nPeter\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Sofie Lenaerts\\\\\\\\r\\\\\\\\nTo: Procurement Team\\\\\\\\r\\\\\\\\nCC: Peter Claes\\\\\\\\r\\\\\\\\nSubject: FW: Running out of raw materials again\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nDear all,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nThis is the third time this month. The system should create a purchase requisition when stock hits the reorder point. Is this not configured correctly?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nSofie\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Ahmed Rahman (Procurement Officer)\\\\\\\\r\\\\\\\\nTo: Sofie Lenaerts\\\\\\\\r\\\\\\\\nCC: Procurement Team\\\\\\\\r\\\\\\\\nSubject: Re: Running out of raw materials again\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nHi,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nI think the ERP requires us to manually run the \\xe2\\x80\\x9cMRP batch job\\xe2\\x80\\x9d before it creates purchase requisitions. Maybe we forgot to schedule it?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nAhmed\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Sofie Lenaerts\\\\\\\\r\\\\\\\\nTo: ERP Support\\\\\\\\r\\\\\\\\nSubject: FW: Running out of raw materials again\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nHello,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nCan you check whether it\\xe2\\x80\\x99s possible to have purchase orders (or requisitions) created automatically when stock drops below the reorder point, instead of depending on manual MRP runs?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nThanks,\\\\\\\\r\\\\\\\\nSofie\\\\\\\\r\\\\\\\\n\\\\\"},\\\\\"from\\\\\":{\\\\\"emailAddress\\\\\":{\\\\\"name\\\\\":\\\\\"Peter Heyse\\\\\",\\\\\"address\\\\\":\\\\\"peter.heyse@cerm.net\\\\\"}},\\\\\"toRecipients\\\\\":[{\\\\\"emailAddress\\\\\":{\\\\\"name\\\\\":\\\\\"Simon Stijnen\\\\\",\\\\\"address\\\\\":\\\\\"simon@cerm.be\\\\\"}}],\\\\\"ccRecipients\\\\\":[{\\\\\"emailAddress\\\\\":{\\\\\"name\\\\\":\\\\\"Liesbet Lanssens\\\\\",\\\\\"address\\\\\":\\\\\"liesbet.lanssens@cerm.net\\\\\"}}],\\\\\"_cache_status\\\\\":\\\\\"miss\\\\\",\\\\\"_cached_at\\\\\":\\\\\"2025-11-26T13:54:43.324766+00:00\\\\\"},{\\\\\"@odata.etag\\\\\":\\\\\"W/\\\\\\\\\\\\\"CQAAABYAAADLCf2e1u4cTqSwX4ueiKN3AAA/aAGT\\\\\\\\\\\\\"\\\\\",\\\\\"id\\\\\":\\\\\"AAMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgBGAAAAAACwtNzdyw3yQpjTu3qPaUVNBwDLCf2e1u4cTqSwX4ueiKN3AAAAAAEMAADLCf2e1u4cTqSwX4ueiKN3AAA-gl70AAA=\\\\\",\\\\\"receivedDateTime\\\\\":\\\\\"2025-08-28T15:21:51Z\\\\\",\\\\\"hasAttachments\\\\\":false,\\\\\"subject\\\\\":\\\\\"FW: returns\\\\\",\\\\\"conversationId\\\\\":\\\\\"AAQkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgAQACTAogssNElNt982PtWCrTw=\\\\\",\\\\\"isRead\\\\\":true,\\\\\"body\\\\\":{\\\\\"contentType\\\\\":\\\\\"text\\\\\",\\\\\"content\\\\\":\\\\\"Hi Simon,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nWe have a question about our CERM system, please see below what my colleagues need.\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nThank you,\\\\\\\\r\\\\\\\\nPeter Heyse\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n[CERM]<https://www.cerm.net/>\\\\\\\\r\\\\\\\\nPeter\\\\\\\\r\\\\\\\\nHeyse   \\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\\\\\\\r\\\\\\\\nDirector of Product Management\\\\\\\\r\\\\\\\\npeter.heyse@cerm.net<mailto:peter.heyse@cerm.net>\\\\\\\\r\\\\\\\\n+32 (0)495 56 29 32<tel:+32%20(0)495%2056%2029%2032>\\\\\\\\r\\\\\\\\n[cid:image704520.png@5C250D76.0B53EF10]<https://www.facebook.com/cermmis>\\\\\\\\r\\\\\\\\n[cid:image882482.png@DC4F61C6.4D143DC8]<https://www.linkedin.com/company/cerm>\\\\\\\\r\\\\\\\\n[cid:image518288.png@F0EED8BD.D26AFA69]<https://www.cerm.net/>\\\\\\\\r\\\\\\\\n[Visit us at Labelexpo! Booth #3G43]<https://www.cerm.net/events/labelexpo-europe-2025>\\\\\\\\r\\\\\\\\nFrom: Peter Heyse <peter.heyse@gmail.com>\\\\\\\\r\\\\\\\\nSent: donderdag 28 augustus 2025 15:08\\\\\\\\r\\\\\\\\nTo: Peter Heyse <peter.heyse@cerm.net>\\\\\\\\r\\\\\\\\nSubject: returns\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Lien Jacobs (Customer Service)\\\\\\\\r\\\\\\\\nTo: Kristof Meyers (Returns Coordinator)\\\\\\\\r\\\\\\\\nSubject: Complicated return from TechParts Ltd\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nHi Kristof,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nCustomer TechParts wants to return 12 monitors because of defects. Normally, we create a credit note once we receive the goods, but they are asking if they can already get a replacement shipment while the return is still on the way.\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nDo we have a process for this in ERP?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nThanks,\\\\\\\\r\\\\\\\\nLien\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Kristof Meyers\\\\\\\\r\\\\\\\\nTo: Lien Jacobs\\\\\\\\r\\\\\\\\nCC: Accounting, Warehouse\\\\\\\\r\\\\\\\\nSubject: Re: Complicated return from TechParts Ltd\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nLien,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nAs far as I know, ERP only allows a return order first. After warehouse confirms the return, only then can we issue a replacement.\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nBut I remember someone said there was a setting for \\xe2\\x80\\x9cadvance replacement.\\xe2\\x80\\x9d\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nKristof\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Sophie Janssens (Accounting)\\\\\\\\r\\\\\\\\nTo: Kristof Meyers\\\\\\\\r\\\\\\\\nCC: Lien Jacobs\\\\\\\\r\\\\\\\\nSubject: Re: Complicated return from TechParts Ltd\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nIf we send replacements before goods are back, there\\xe2\\x80\\x99s a financial risk. Still, big customers push for this. Maybe ERP has an option to block the invoice until return is processed?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nSophie\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nFrom: Lien Jacobs\\\\\\\\r\\\\\\\\nTo: ERP Specialist\\\\\\\\r\\\\\\\\nCC: Returns Team, Accounting\\\\\\\\r\\\\\\\\nSubject: FW: Complicated return from TechParts Ltd\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nHi,\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nCan you confirm if ERP supports advance replacement for returns, i.e. shipping replacement goods before receiving the returned items, while ensuring financial controls are still in place?\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\nThanks,\\\\\\\\r\\\\\\\\nLien\\\\\\\\r\\\\\\\\n\\\\\\\\r\\\\\\\\n________________________________\\\\\\\\r\\\\\\\\n\\\\\"},\\\\\"from\\\\\":{\\\\\"emailAddress\\\\\":{\\\\\"name\\\\\":\\\\\"Peter Heyse\\\\\",\\\\\"address\\\\\":\\\\\"peter.heyse@cerm.net\\\\\"}},\\\\\"toRecipients\\\\\":[{\\\\\"emailAddress\\\\\":{\\\\\"name\\\\\":\\\\\"Simon Stijnen\\\\\",\\\\\"address\\\\\":\\\\\"simon@cerm.be\\\\\"}}],\\\\\"ccRecipients\\\\\":[{\\\\\"emailAddress\\\\\":{\\\\\"name\\\\\":\\\\\"Liesbet Lanssens\\\\\",\\\\\"address\\\\\":\\\\\"liesbet.lanssens@cerm.net\\\\\"}}],\\\\\"_cache_status\\\\\":\\\\\"miss\\\\\",\\\\\"_cached_at\\\\\":\\\\\"2025-11-26T13:54:43.324766+00:00\\\\\"}]\"}],\"structuredContent\":{\"result\":[{\"@odata.etag\":\"W/\\\\\"CQAAABYAAADLCf2e1u4cTqSwX4ueiKN3AAA/aAFp\\\\\"\",\"id\":\"AAMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgBGAAAAAACwtNzdyw3yQpjTu3qPaUVNBwDLCf2e1u4cTqSwX4ueiKN3AAAAAAEMAADLCf2e1u4cTqSwX4ueiKN3AAA-gl7zAAA=\",\"receivedDateTime\":\"2025-08-28T15:22:04Z\",\"hasAttachments\":false,\"subject\":\"FW: Inventory Reorder Automation\",\"conversationId\":\"AAQkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgAQAJBSqYLPJShDiGuicb-XMo8=\",\"isRead\":true,\"body\":{\"contentType\":\"text\",\"content\":\"Hi Simon,\\\\r\\\\n\\\\r\\\\nWe have a question about our CERM system, please see below what my colleagues need.\\\\r\\\\n\\\\r\\\\nThank you,\\\\r\\\\nPeter Heyse\\\\r\\\\n\\\\r\\\\n[CERM]<https://www.cerm.net/>\\\\r\\\\nPeter\\\\r\\\\nHeyse   \\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\\\r\\\\nDirector of Product Management\\\\r\\\\npeter.heyse@cerm.net<mailto:peter.heyse@cerm.net>\\\\r\\\\n+32 (0)495 56 29 32<tel:+32%20(0)495%2056%2029%2032>\\\\r\\\\n[cid:image911450.png@BF25339E.CC63810A]<https://www.facebook.com/cermmis>\\\\r\\\\n[cid:image050711.png@734C55C8.D05C30E2]<https://www.linkedin.com/company/cerm>\\\\r\\\\n[cid:image689168.png@A083C1C3.3A498EF4]<https://www.cerm.net/>\\\\r\\\\n[Visit us at Labelexpo! Booth #3G43]<https://www.cerm.net/events/labelexpo-europe-2025>\\\\r\\\\nFrom: Peter Heyse <peter.heyse@gmail.com>\\\\r\\\\nSent: donderdag 28 augustus 2025 15:06\\\\r\\\\nTo: Peter Heyse <peter.heyse@cerm.net>\\\\r\\\\nSubject: Inventory Reorder Automation\\\\r\\\\n\\\\r\\\\n\\\\r\\\\nFrom: Peter Claes (Warehouse Clerk)\\\\r\\\\nTo: Sofie Lenaerts (Inventory Manager)\\\\r\\\\nSubject: Running out of raw materials again\\\\r\\\\n\\\\r\\\\nHi Sofie,\\\\r\\\\n\\\\r\\\\nWe had another case this morning \\xe2\\x80\\x94 production stopped for 2 hours because we didn\\xe2\\x80\\x99t have enough raw plastic. I checked in ERP and saw the minimum stock level was already reached last Friday. No purchase order was created automatically.\\\\r\\\\n\\\\r\\\\nAm I doing something wrong when checking the reorder settings?\\\\r\\\\n\\\\r\\\\nPeter\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\\\\r\\\\nFrom: Sofie Lenaerts\\\\r\\\\nTo: Procurement Team\\\\r\\\\nCC: Peter Claes\\\\r\\\\nSubject: FW: Running out of raw materials again\\\\r\\\\n\\\\r\\\\nDear all,\\\\r\\\\n\\\\r\\\\nThis is the third time this month. The system should create a purchase requisition when stock hits the reorder point. Is this not configured correctly?\\\\r\\\\n\\\\r\\\\nSofie\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\\\\r\\\\nFrom: Ahmed Rahman (Procurement Officer)\\\\r\\\\nTo: Sofie Lenaerts\\\\r\\\\nCC: Procurement Team\\\\r\\\\nSubject: Re: Running out of raw materials again\\\\r\\\\n\\\\r\\\\nHi,\\\\r\\\\n\\\\r\\\\nI think the ERP requires us to manually run the \\xe2\\x80\\x9cMRP batch job\\xe2\\x80\\x9d before it creates purchase requisitions. Maybe we forgot to schedule it?\\\\r\\\\n\\\\r\\\\nAhmed\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\\\\r\\\\nFrom: Sofie Lenaerts\\\\r\\\\nTo: ERP Support\\\\r\\\\nSubject: FW: Running out of raw materials again\\\\r\\\\n\\\\r\\\\nHello,\\\\r\\\\n\\\\r\\\\nCan you check whether it\\xe2\\x80\\x99s possible to have purchase orders (or requisitions) created automatically when stock drops below the reorder point, instead of depending on manual MRP runs?\\\\r\\\\n\\\\r\\\\nThanks,\\\\r\\\\nSofie\\\\r\\\\n\"},\"from\":{\"emailAddress\":{\"name\":\"Peter Heyse\",\"address\":\"peter.heyse@cerm.net\"}},\"toRecipients\":[{\"emailAddress\":{\"name\":\"Simon Stijnen\",\"address\":\"simon@cerm.be\"}}],\"ccRecipients\":[{\"emailAddress\":{\"name\":\"Liesbet Lanssens\",\"address\":\"liesbet.lanssens@cerm.net\"}}],\"_cache_status\":\"miss\",\"_cached_at\":\"2025-11-26T13:54:43.324766+00:00\"},{\"@odata.etag\":\"W/\\\\\"CQAAABYAAADLCf2e1u4cTqSwX4ueiKN3AAA/aAGT\\\\\"\",\"id\":\"AAMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgBGAAAAAACwtNzdyw3yQpjTu3qPaUVNBwDLCf2e1u4cTqSwX4ueiKN3AAAAAAEMAADLCf2e1u4cTqSwX4ueiKN3AAA-gl70AAA=\",\"receivedDateTime\":\"2025-08-28T15:21:51Z\",\"hasAttachments\":false,\"subject\":\"FW: returns\",\"conversationId\":\"AAQkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjY2NmIzODhjZgAQACTAogssNElNt982PtWCrTw=\",\"isRead\":true,\"body\":{\"contentType\":\"text\",\"content\":\"Hi Simon,\\\\r\\\\n\\\\r\\\\nWe have a question about our CERM system, please see below what my colleagues need.\\\\r\\\\n\\\\r\\\\nThank you,\\\\r\\\\nPeter Heyse\\\\r\\\\n\\\\r\\\\n[CERM]<https://www.cerm.net/>\\\\r\\\\nPeter\\\\r\\\\nHeyse   \\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\xe2\\x80\\x8b\\\\r\\\\nDirector of Product Management\\\\r\\\\npeter.heyse@cerm.net<mailto:peter.heyse@cerm.net>\\\\r\\\\n+32 (0)495 56 29 32<tel:+32%20(0)495%2056%2029%2032>\\\\r\\\\n[cid:image704520.png@5C250D76.0B53EF10]<https://www.facebook.com/cermmis>\\\\r\\\\n[cid:image882482.png@DC4F61C6.4D143DC8]<https://www.linkedin.com/company/cerm>\\\\r\\\\n[cid:image518288.png@F0EED8BD.D26AFA69]<https://www.cerm.net/>\\\\r\\\\n[Visit us at Labelexpo! Booth #3G43]<https://www.cerm.net/events/labelexpo-europe-2025>\\\\r\\\\nFrom: Peter Heyse <peter.heyse@gmail.com>\\\\r\\\\nSent: donderdag 28 augustus 2025 15:08\\\\r\\\\nTo: Peter Heyse <peter.heyse@cerm.net>\\\\r\\\\nSubject: returns\\\\r\\\\n\\\\r\\\\n\\\\r\\\\nFrom: Lien Jacobs (Customer Service)\\\\r\\\\nTo: Kristof Meyers (Returns Coordinator)\\\\r\\\\nSubject: Complicated return from TechParts Ltd\\\\r\\\\n\\\\r\\\\nHi Kristof,\\\\r\\\\n\\\\r\\\\nCustomer TechParts wants to return 12 monitors because of defects. Normally, we create a credit note once we receive the goods, but they are asking if they can already get a replacement shipment while the return is still on the way.\\\\r\\\\n\\\\r\\\\nDo we have a process for this in ERP?\\\\r\\\\n\\\\r\\\\nThanks,\\\\r\\\\nLien\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\\\\r\\\\nFrom: Kristof Meyers\\\\r\\\\nTo: Lien Jacobs\\\\r\\\\nCC: Accounting, Warehouse\\\\r\\\\nSubject: Re: Complicated return from TechParts Ltd\\\\r\\\\n\\\\r\\\\nLien,\\\\r\\\\n\\\\r\\\\nAs far as I know, ERP only allows a return order first. After warehouse confirms the return, only then can we issue a replacement.\\\\r\\\\n\\\\r\\\\nBut I remember someone said there was a setting for \\xe2\\x80\\x9cadvance replacement.\\xe2\\x80\\x9d\\\\r\\\\n\\\\r\\\\nKristof\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\\\\r\\\\nFrom: Sophie Janssens (Accounting)\\\\r\\\\nTo: Kristof Meyers\\\\r\\\\nCC: Lien Jacobs\\\\r\\\\nSubject: Re: Complicated return from TechParts Ltd\\\\r\\\\n\\\\r\\\\nIf we send replacements before goods are back, there\\xe2\\x80\\x99s a financial risk. Still, big customers push for this. Maybe ERP has an option to block the invoice until return is processed?\\\\r\\\\n\\\\r\\\\nSophie\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\\\\r\\\\nFrom: Lien Jacobs\\\\r\\\\nTo: ERP Specialist\\\\r\\\\nCC: Returns Team, Accounting\\\\r\\\\nSubject: FW: Complicated return from TechParts Ltd\\\\r\\\\n\\\\r\\\\nHi,\\\\r\\\\n\\\\r\\\\nCan you confirm if ERP supports advance replacement for returns, i.e. shipping replacement goods before receiving the returned items, while ensuring financial controls are still in place?\\\\r\\\\n\\\\r\\\\nThanks,\\\\r\\\\nLien\\\\r\\\\n\\\\r\\\\n________________________________\\\\r\\\\n\"},\"from\":{\"emailAddress\":{\"name\":\"Peter Heyse\",\"address\":\"peter.heyse@cerm.net\"}},\"toRecipients\":[{\"emailAddress\":{\"name\":\"Simon Stijnen\",\"address\":\"simon@cerm.be\"}}],\"ccRecipients\":[{\"emailAddress\":{\"name\":\"Liesbet Lanssens\",\"address\":\"liesbet.lanssens@cerm.net\"}}],\"_cache_status\":\"miss\",\"_cached_at\":\"2025-11-26T13:54:43.324766+00:00\"}]},\"isError\":false}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T13:54:43.327264+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T13:54:58.328744+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:54:58.328669+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:55:13.329282+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:55:13.329208+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:55:28.331259+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:55:28.331177+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:55:43.332240+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:55:43.332131+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:55:58.332975+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:55:58.332898+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:56:13.334354+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:56:13.334266+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:56:28.335101+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:56:28.335026+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:56:43.335766+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:56:43.335672+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:56:58.336379+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:56:58.336303+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:57:13.336935+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:57:13.336851+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:57:28.338090+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:57:28.338016+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:57:43.339100+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:57:43.339010+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:57:58.339530+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:57:58.339440+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:58:13.340465+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:58:13.340391+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:58:28.341684+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:58:28.341590+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:58:43.342301+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 13:58:43.342230+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T13:58:51.331257+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T13:58:51.331904+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b8c73b00>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T13:58:51.331987+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type CallToolRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T13:58:51.332045+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type CallToolRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T13:58:51.333632+00:00", "level": "DEBUG", "logger": "urllib3.util.retry", "message": "Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)", "module": "retry", "function": "from_int", "line": 286}
{"timestamp": "2025-11-26T13:58:51.333707+00:00", "level": "DEBUG", "logger": "msal.authority", "message": "Initializing with Entra authority: https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802", "module": "authority", "function": "__init__", "line": 75}
{"timestamp": "2025-11-26T13:58:51.334107+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "Starting new HTTPS connection (1): login.microsoftonline.com:443", "module": "connectionpool", "function": "_new_conn", "line": 1049}
{"timestamp": "2025-11-26T13:58:51.535305+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"GET /503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0/.well-known/openid-configuration HTTP/1.1\" 200 1964", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:58:51.535727+00:00", "level": "DEBUG", "logger": "msal.authority", "message": "openid_config(\"https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic', 'self_signed_tls_client_auth'], 'jwks_uri': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/kerberos', 'mtls_endpoint_aliases': {'token_endpoint': 'https://mtlsauth.microsoft.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token'}, 'tls_client_certificate_bound_access_tokens': True, 'tenant_region_scope': 'EU', 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}", "module": "authority", "function": "__init__", "line": 96}
{"timestamp": "2025-11-26T13:58:51.535795+00:00", "level": "DEBUG", "logger": "msal.application", "message": "Broker enabled? None", "module": "application", "function": "_decide_broker", "line": 718}
{"timestamp": "2025-11-26T13:58:51.680476+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/devicecode HTTP/1.1\" 200 473", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:58:51.680830+00:00", "level": "DEBUG", "logger": "msal.telemetry", "message": "Generate or reuse correlation_id: ccd60270-0455-4669-88ec-e4cf198ac58c", "module": "telemetry", "function": "__init__", "line": 37}
{"timestamp": "2025-11-26T13:58:51.766368+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:58:56.848091+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:01.955478+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:07.702894+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:13.679493+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:18.873299+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:24.043531+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:29.160548+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:34.247577+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:39.393410+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:44.449023+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:49.631408+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:54.775242+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T13:59:59.846115+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:05.142105+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:10.263856+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:15.395532+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:20.463207+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:25.531705+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:30.721730+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:35.898188+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 200 5380", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:00:35.898567+00:00", "level": "DEBUG", "logger": "msal.token_cache", "message": "event={\n    \"client_id\": \"0e0cad2c-a7d7-485d-9604-59e172bcb86f\",\n    \"data\": {\n        \"claims\": null,\n        \"client_id\": \"0e0cad2c-a7d7-485d-9604-59e172bcb86f\",\n        \"code\": \"GAQABIQEAAABlMNzVhAPUTrARzfQjWPtK-GiK0lBmjRJsivv6EVZihu9maUlwSPaNkv1rmpz_0aQlRW51NZSe4vGWEjSuTLyXpj7NlNjRrhwB0hzb7jxForuYd5Ny31dK6FWSy69dBZtmforU3i2TVRyt1emmmxuNjjm4Gki-hUg6nH18det378fN6vFFK2B3MYOk9t5SVrwgAA\",\n        \"device_code\": \"GAQABIQEAAABlMNzVhAPUTrARzfQjWPtK-GiK0lBmjRJsivv6EVZihu9maUlwSPaNkv1rmpz_0aQlRW51NZSe4vGWEjSuTLyXpj7NlNjRrhwB0hzb7jxForuYd5Ny31dK6FWSy69dBZtmforU3i2TVRyt1emmmxuNjjm4Gki-hUg6nH18det378fN6vFFK2B3MYOk9t5SVrwgAA\"\n    },\n    \"environment\": \"login.microsoftonline.com\",\n    \"grant_type\": \"urn:ietf:params:oauth:grant-type:device_code\",\n    \"params\": null,\n    \"response\": {\n        \"access_token\": \"********\",\n        \"client_info\": \"eyJ1aWQiOiIwMzgwYzFlNy1jY2FmLTQ4ODYtYmJjYy00NGZhZjhlZjM0ZDMiLCJ1dGlkIjoiNTAzMjUzYzEtZDA0Ny00ZDU1LWE1ZTctZWI2YjBmYzM0ODAyIn0\",\n        \"expires_in\": 5345,\n        \"ext_expires_in\": 5345,\n        \"id_token\": \"********\",\n        \"refresh_token\": \"********\",\n        \"scope\": \"Mail.Read Mail.ReadWrite Mail.Send openid profile User.Read email\",\n        \"token_type\": \"Bearer\"\n    },\n    \"scope\": [\n        \"Mail.Read\",\n        \"Mail.ReadWrite\",\n        \"Mail.Send\",\n        \"openid\",\n        \"profile\",\n        \"User.Read\",\n        \"email\"\n    ],\n    \"token_endpoint\": \"https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token\"\n}", "module": "token_cache", "function": "add", "line": 210}
{"timestamp": "2025-11-26T14:00:36.140255+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T14:00:36.140359+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:00:36.140329+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:00:36.140397+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:00:36.140380+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:00:36.140544+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T14:00:36.140622+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":3,\"result\":{\"content\":[{\"type\":\"text\",\"text\":\"[{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAArRiAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Archive\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":0,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":0,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAArRaAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Conversation History\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":1,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":0,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEKAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Deleted Items\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":0,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":14,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEPAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Drafts\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":0,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":0,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEMAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Inbox\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":4,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":2,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAArRNAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Junk Email\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":0,\\\\\"unreadItemCount\\\\\":1,\\\\\"totalItemCount\\\\\":1,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgELAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Outbox\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":0,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":0,\\\\\"isHidden\\\\\":false},{\\\\\"id\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEJAAAA\\\\\",\\\\\"displayName\\\\\":\\\\\"Sent Items\\\\\",\\\\\"parentFolderId\\\\\":\\\\\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\\\\\",\\\\\"childFolderCount\\\\\":0,\\\\\"unreadItemCount\\\\\":0,\\\\\"totalItemCount\\\\\":28,\\\\\"isHidden\\\\\":false}]\"}],\"structuredContent\":{\"result\":[{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAArRiAAAA\",\"displayName\":\"Archive\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":0,\"unreadItemCount\":0,\"totalItemCount\":0,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAArRaAAAA\",\"displayName\":\"Conversation History\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":1,\"unreadItemCount\":0,\"totalItemCount\":0,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEKAAAA\",\"displayName\":\"Deleted Items\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":0,\"unreadItemCount\":0,\"totalItemCount\":14,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEPAAAA\",\"displayName\":\"Drafts\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":0,\"unreadItemCount\":0,\"totalItemCount\":0,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEMAAAA\",\"displayName\":\"Inbox\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":4,\"unreadItemCount\":0,\"totalItemCount\":2,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAArRNAAAA\",\"displayName\":\"Junk Email\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":0,\"unreadItemCount\":1,\"totalItemCount\":1,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgELAAAA\",\"displayName\":\"Outbox\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":0,\"unreadItemCount\":0,\"totalItemCount\":0,\"isHidden\":false},{\"id\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEJAAAA\",\"displayName\":\"Sent Items\",\"parentFolderId\":\"AQMkADAzOTgzNzg2LTU2MjctNDVjNy05NDdhLTk4NjYCYjM4OABjZgAuAAADsLTc3csN8kKY07t6j2lFTQEAywn9ntbuHE6ksF_LnoijdwAAAgEIAAAA\",\"childFolderCount\":0,\"unreadItemCount\":0,\"totalItemCount\":28,\"isHidden\":false}]},\"isError\":false}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T14:00:36.140774+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:00:51.141328+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:00:51.141242+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:01:06.141761+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:01:06.141673+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:01:21.142595+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:01:21.142524+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:01:36.143855+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:01:36.143785+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:01:51.144419+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:01:51.144339+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:02:06.146231+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:02:06.146152+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:02:21.148476+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:02:21.148397+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:02:36.150767+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:02:36.150693+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:02:51.151641+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:02:51.151560+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:03:06.152550+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:03:06.152465+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:03:21.154123+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:03:21.154051+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:03:36.155058+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:03:36.154987+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:03:51.155805+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:03:51.155673+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:04:06.156844+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:04:06.156752+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:04:21.157769+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:04:21.157655+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:04:36.159171+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:04:36.159100+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:04:51.160098+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:04:51.160027+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:05:06.161135+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:05:06.161064+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:05:21.161527+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:05:21.161454+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:05:36.162225+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:05:36.162132+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:05:51.163269+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:05:51.163183+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:06:06.163722+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:06:06.163634+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:06:21.164270+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "ping: b': ping - 2025-11-26 14:06:21.164195+00:00\\r\\n\\r\\n'", "module": "sse", "function": "_ping", "line": 236}
{"timestamp": "2025-11-26T14:06:33.720897+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:06:33.721030+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T14:06:38.824926+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T14:06:38.827401+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: 0aabd159c97f4d57b55dbd56b3bb61aa", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T14:06:38.830028+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T14:06:38.830078+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T14:06:38.830205+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:06:38.831621+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:06:38.831943+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:06:38.832264+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T14:06:38.832947+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:06:38.833302+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b8c6c050>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T14:06:38.833356+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T14:06:38.833404+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T14:06:38.834012+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T14:06:38.834364+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T14:06:38.834771+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T14:06:38.835116+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:06:38.838394+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:06:38.838430+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: 0aabd159c97f4d57b55dbd56b3bb61aa", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-26T14:06:38.838618+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-26T14:06:38.838809+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:07:12.845381+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-26T14:07:12.845482+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: 5382b3c7b5374a1baa5d6afac1419ae4", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-26T14:07:12.847256+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T14:07:12.847308+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T14:07:12.847446+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:07:12.849102+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:07:12.849435+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:07:12.849741+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T14:07:12.851734+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:07:12.852239+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b905e6f0>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T14:07:12.852295+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T14:07:12.852348+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T14:07:12.852845+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-26T14:07:12.853233+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-26T14:07:12.853632+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-26T14:07:12.853978+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-26T14:07:16.952446+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-26T14:07:16.953185+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7499b8c84b60>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-26T14:07:16.953278+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type CallToolRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-26T14:07:16.953336+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type CallToolRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-26T14:07:16.955651+00:00", "level": "DEBUG", "logger": "urllib3.util.retry", "message": "Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)", "module": "retry", "function": "from_int", "line": 286}
{"timestamp": "2025-11-26T14:07:16.955751+00:00", "level": "DEBUG", "logger": "msal.authority", "message": "Initializing with Entra authority: https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802", "module": "authority", "function": "__init__", "line": 75}
{"timestamp": "2025-11-26T14:07:16.956078+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "Starting new HTTPS connection (1): login.microsoftonline.com:443", "module": "connectionpool", "function": "_new_conn", "line": 1049}
{"timestamp": "2025-11-26T14:07:17.116275+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"GET /503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0/.well-known/openid-configuration HTTP/1.1\" 200 1964", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:17.116693+00:00", "level": "DEBUG", "logger": "msal.authority", "message": "openid_config(\"https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic', 'self_signed_tls_client_auth'], 'jwks_uri': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/kerberos', 'mtls_endpoint_aliases': {'token_endpoint': 'https://mtlsauth.microsoft.com/503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token'}, 'tls_client_certificate_bound_access_tokens': True, 'tenant_region_scope': 'EU', 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}", "module": "authority", "function": "__init__", "line": 96}
{"timestamp": "2025-11-26T14:07:17.116770+00:00", "level": "DEBUG", "logger": "msal.application", "message": "Broker enabled? None", "module": "application", "function": "_decide_broker", "line": 718}
{"timestamp": "2025-11-26T14:07:17.260568+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/devicecode HTTP/1.1\" 200 473", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:17.260898+00:00", "level": "DEBUG", "logger": "msal.telemetry", "message": "Generate or reuse correlation_id: a95f9cd4-0dd5-4757-a6fc-bd765615a42a", "module": "telemetry", "function": "__init__", "line": 37}
{"timestamp": "2025-11-26T14:07:17.328049+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:23.039370+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:28.189922+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:33.274645+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:38.345903+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:43.501123+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:48.689686+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:53.766452+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:07:58.845170+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:04.030163+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:09.120953+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:14.201897+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:19.290790+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:24.385076+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:29.510753+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:34.584830+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:39.655172+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:44.742619+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:49.969568+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:08:55.083757+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:00.166078+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:05.237586+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:10.327771+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:15.797334+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:20.868578+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:25.964514+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:31.042614+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:36.117309+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:41.187558+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:46.277420+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:51.362632+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
{"timestamp": "2025-11-26T14:09:56.461039+00:00", "level": "DEBUG", "logger": "urllib3.connectionpool", "message": "https://login.microsoftonline.com:443 \"POST /503253c1-d047-4d55-a5e7-eb6b0fc34802/oauth2/v2.0/token HTTP/1.1\" 400 501", "module": "connectionpool", "function": "_make_request", "line": 544}
