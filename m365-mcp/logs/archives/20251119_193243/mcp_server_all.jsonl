{"timestamp": "2025-11-19T16:39:14.008382+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Previous logs archived: 3 file(s) \u2192 archives/20251119_163914", "module": "logging_config", "function": "setup_logging", "line": 215}
{"timestamp": "2025-11-19T16:39:14.008481+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Logging initialized - Level: INFO", "module": "logging_config", "function": "setup_logging", "line": 222}
{"timestamp": "2025-11-19T16:39:14.008535+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Log directory: /workspaces/email-agent/m365-mcp/logs", "module": "logging_config", "function": "setup_logging", "line": 223}
{"timestamp": "2025-11-19T16:39:14.008570+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "All logs: mcp_server_all.jsonl", "module": "logging_config", "function": "setup_logging", "line": 224}
{"timestamp": "2025-11-19T16:39:14.008601+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Error logs: mcp_server_errors.jsonl", "module": "logging_config", "function": "setup_logging", "line": 225}
{"timestamp": "2025-11-19T16:39:14.008635+00:00", "level": "INFO", "logger": "microsoft_mcp.logging", "message": "Readable logs: mcp_server.log", "module": "logging_config", "function": "setup_logging", "line": 226}
{"timestamp": "2025-11-19T16:39:14.009206+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "================================================================================", "module": "server", "function": "_log_startup_info", "line": 53}
{"timestamp": "2025-11-19T16:39:14.009256+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "M365 MCP Server Starting v0.2.3", "module": "server", "function": "_log_startup_info", "line": 54}
{"timestamp": "2025-11-19T16:39:14.009289+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "================================================================================", "module": "server", "function": "_log_startup_info", "line": 55}
{"timestamp": "2025-11-19T16:39:14.009325+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "PID: 786415", "module": "server", "function": "_log_startup_info", "line": 56}
{"timestamp": "2025-11-19T16:39:14.009354+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Python: 3.12.11 (main, Jul  1 2025, 05:28:02) [GCC 10.2.1 20210110]", "module": "server", "function": "_log_startup_info", "line": 57}
{"timestamp": "2025-11-19T16:39:14.009383+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Working Directory: /workspaces/email-agent/m365-mcp", "module": "server", "function": "_log_startup_info", "line": 58}
{"timestamp": "2025-11-19T16:39:14.009411+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Environment Variables:", "module": "server", "function": "_log_startup_info", "line": 59}
{"timestamp": "2025-11-19T16:39:14.009442+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  M365_MCP_CLIENT_ID: 0e0cad2c...b86f", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-19T16:39:14.009473+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_TRANSPORT: http", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-19T16:39:14.009502+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_HOST: 0.0.0.0", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-19T16:39:14.009537+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_PORT: 8400", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-19T16:39:14.009563+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "  MCP_AUTH_METHOD: none", "module": "server", "function": "_log_startup_info", "line": 71}
{"timestamp": "2025-11-19T16:39:14.009595+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "================================================================================", "module": "server", "function": "_log_startup_info", "line": 72}
{"timestamp": "2025-11-19T16:39:14.009630+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Transport mode: http", "module": "server", "function": "main", "line": 126}
{"timestamp": "2025-11-19T16:39:14.009671+00:00", "level": "WARNING", "logger": "m365_mcp.server", "message": "Binding to all network interfaces (0.0.0.0) - ensure firewall is configured!", "module": "server", "function": "main", "line": 135}
{"timestamp": "2025-11-19T16:39:14.009705+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Authentication method: none", "module": "server", "function": "main", "line": 145}
{"timestamp": "2025-11-19T16:39:14.009734+00:00", "level": "WARNING", "logger": "m365_mcp.server", "message": "Running HTTP server without authentication!", "module": "server", "function": "main", "line": 148}
{"timestamp": "2025-11-19T16:39:14.009768+00:00", "level": "INFO", "logger": "m365_mcp.server", "message": "Starting HTTP transport on 0.0.0.0:8400/mcp", "module": "server", "function": "main", "line": 173}
{"timestamp": "2025-11-19T16:39:14.009797+00:00", "level": "WARNING", "logger": "m365_mcp.server", "message": "Running in insecure mode (no authentication)", "module": "server", "function": "main", "line": 187}
{"timestamp": "2025-11-19T16:39:14.011653+00:00", "level": "DEBUG", "logger": "asyncio", "message": "Using selector: EpollSelector", "module": "selector_events", "function": "__init__", "line": 64}
{"timestamp": "2025-11-19T16:39:14.020199+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "StreamableHTTP session manager started", "module": "streamable_http_manager", "function": "run", "line": 110}
{"timestamp": "2025-11-19T16:51:30.781734+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-19T16:51:30.781913+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: dad568d5bcc544dd93f9a1429a022c8d", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-19T16:51:30.784373+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-19T16:51:30.784486+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-19T16:51:30.784676+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:51:30.786526+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:30.787004+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:30.787532+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-19T16:51:30.787892+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:30.788372+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7a17193f8a40>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-19T16:51:30.788448+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-19T16:51:30.788513+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-19T16:51:30.789960+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-19T16:51:30.790935+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-19T16:51:30.792268+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"account_list\",\"title\":\"List Accounts\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all signed-in Microsoft accounts (read-only, safe for unsupervised use)\\\\n\\\\nReturns a list of authenticated Microsoft accounts with their usernames, account IDs,\\\\nand account types (personal or work/school).\\\\n\\\\nReturns:\\\\n    List of account dictionaries with:\\\\n    - username: Account email/username\\\\n    - account_id: Unique account identifier\\\\n    - account_type: \\\\\"personal\\\\\", \\\\\"work_school\\\\\", or \\\\\"unknown\\\\\"\\\\n\\\\nExample:\\\\n    [\\\\n        {\\\\n            \\\\\"username\\\\\": \\\\\"user@outlook.com\\\\\",\\\\n            \\\\\"account_id\\\\\": \\\\\"abc123...\\\\\",\\\\n            \\\\\"account_type\\\\\": \\\\\"personal\\\\\"\\\\n        },\\\\n        {\\\\n            \\\\\"username\\\\\": \\\\\"user@contoso.com\\\\\",\\\\n            \\\\\"account_id\\\\\": \\\\\"def456...\\\\\",\\\\n            \\\\\"account_type\\\\\": \\\\\"work_school\\\\\"\\\\n        }\\\\n    ]\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Accounts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"account_authenticate\",\"title\":\"Authenticate Account\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Authenticate a new Microsoft account using device flow (requires user confirmation recommended)\\\\n\\\\nInitiates device flow authentication for adding a new Microsoft account.\\\\nReturns authentication instructions with a device code and verification URL.\\\\n\\\\nThe user must:\\\\n1. Visit the verification URL\\\\n2. Enter the device code\\\\n3. Sign in with their Microsoft account\\\\n4. Use account_complete_auth to finish the process\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Authenticate Account\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"account_complete_auth\",\"title\":\"Complete Authentication\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Complete device flow authentication (requires user confirmation recommended)\\\\n\\\\nCompletes the authentication process after the user has entered the device code\\\\nat the verification URL.\\\\n\\\\nArgs:\\\\n    flow_cache: The flow data returned from account_authenticate (the _flow_cache field)\\\\n\\\\nReturns:\\\\n    Account information if authentication was successful, or pending status if\\\\n    the user hasn\\'t completed authentication yet.\",\"inputSchema\":{\"properties\":{\"flow_cache\":{\"type\":\"string\"}},\"required\":[\"flow_cache\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Complete Authentication\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_list_events\",\"title\":\"List Calendar Events\",\"description\":\"\\xf0\\x9f\\x93\\x96 List upcoming calendar events (read-only, safe for unsupervised use)\\\\n\\\\nReturns calendar events from now until the specified number of days ahead.\\\\n\\\\nCaching: Results are cached for 5 minutes (fresh) / 30 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    days_ahead: Number of days ahead to look for events (1-365, default: 7)\\\\n    include_details: Include full event details like attendees and body (default: False)\\\\n    limit: Maximum events to return (1-200, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of calendar events with metadata.\\\\n    Each event includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"days_ahead\":{\"default\":7,\"type\":\"integer\"},\"include_details\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Calendar Events\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_get_event\",\"title\":\"Get Calendar Event\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get full event details (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete event information including recurrence patterns and online meeting details.\\\\n\\\\nArgs:\\\\n    event_id: The event ID\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    Complete event object with all metadata\",\"inputSchema\":{\"properties\":{\"event_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"event_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Calendar Event\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_create_event\",\"title\":\"Create Calendar Event\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a calendar event (requires user confirmation recommended)\\\\n\\\\nCreates a new calendar event with optional attendees and location.\\\\nAttendees will receive meeting invitations. Addresses are validated,\\\\ndeduplicated, and limited to 500 unique recipients.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    subject: Event title\\\\n    start: Start time in ISO format (e.g., \\\\\"2024-01-15T10:00:00\\\\\")\\\\n    end: End time in ISO format\\\\n    location: Location name (optional)\\\\n    body: Event description (optional)\\\\n    attendees: Email address(es) of attendees (optional)\\\\n    timezone: Timezone for the event (default: \\\\\"UTC\\\\\")\\\\n\\\\nReturns:\\\\n    Created event object with ID\\\\n\\\\nRaises:\\\\n    ValidationError: If datetime values, timezone, or attendee\\\\n        addresses are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"subject\":{\"type\":\"string\"},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"location\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"timezone\":{\"default\":\"UTC\",\"type\":\"string\"}},\"required\":[\"account_id\",\"subject\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_update_event\",\"title\":\"Update Calendar Event\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update event properties (requires user confirmation recommended)\\\\n\\\\nModifies event details like time, location, or attendees.\\\\nAttendees will receive update notifications.\\\\n\\\\nAllowed update keys: subject, start, end, timezone, location, body, attendees.\\\\n\\\\nArgs:\\\\n    event_id: The event ID to update\\\\n    updates: Dictionary with fields to update (subject, start, end, location, body)\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated event object\",\"inputSchema\":{\"properties\":{\"event_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"event_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_delete_event\",\"title\":\"Delete Calendar Event\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a calendar event (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the event and cannot be undone.\\\\nIf this is a meeting, attendees will receive cancellation notices.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event to delete\\\\n    send_cancellation: Whether to notify attendees (default: True)\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"send_cancellation\":{\"default\":true,\"type\":\"boolean\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"event_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_respond_event\",\"title\":\"Respond to Calendar Event\",\"description\":\"\\xe2\\x9a\\xa0\\xef\\xb8\\x8f Respond to a calendar event invitation (requires user confirmation recommended)\\\\n\\\\nIMPORTANT: This sends a response to the event organizer.\\\\n\\\\nValid responses:\\\\n    - \\\\\"accept\\\\\" - Accept the invitation\\\\n    - \\\\\"decline\\\\\" - Decline the invitation\\\\n    - \\\\\"tentativelyAccept\\\\\" - Mark as tentative\\\\n  (Input is case-insensitive; \\\\\"tentative\\\\\" is accepted as an alias.)\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to respond to\\\\n    response: Response type (default: \\\\\"accept\\\\\")\\\\n    message: Optional message to the organizer\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the response value or message payload is invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"response\":{\"default\":\"accept\",\"type\":\"string\"},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"event_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Respond to Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_check_availability\",\"title\":\"Check Calendar Availability\",\"description\":\"\\xf0\\x9f\\x93\\x96 Check calendar availability for scheduling (read-only, safe for unsupervised use)\\\\n\\\\nReturns free/busy information for the user and optional attendees.\\\\nUseful for finding meeting times.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    start: Start time in ISO format\\\\n    end: End time in ISO format\\\\n    attendees: Optional email address(es) to check availability\\\\n\\\\nReturns:\\\\n    Schedule information with free/busy slots\\\\n\\\\nRaises:\\\\n    ValidationError: If start/end datetimes or attendee addresses\\\\n        are invalid.\\\\n    ValueError: If the current account email address is unavailable.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Check Calendar Availability\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_forward_event\",\"title\":\"Forward Calendar Event\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward a calendar event to recipients (always require user confirmation)\\\\n\\\\nWARNING: Meeting invitation will be sent immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    message: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"event_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_list_calendars\",\"title\":\"List Calendars\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all available calendars (read-only, safe for unsupervised use)\\\\n\\\\nReturns all calendars accessible by the user, including primary calendar\\\\nand any additional calendars (shared, group, etc.).\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of calendar objects with metadata.\\\\n    Each calendar includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Calendars\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_create_calendar\",\"title\":\"Create Calendar\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new calendar (requires user confirmation recommended)\\\\n\\\\nCreates a new calendar in the user\\'s mailbox. Useful for organizing\\\\nevents into separate calendars (work, personal, project-specific, etc.).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    name: Name for the new calendar\\\\n\\\\nReturns:\\\\n    Created calendar object with ID and metadata\\\\n\\\\nRaises:\\\\n    ValidationError: If calendar name is empty or invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Calendar\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_delete_calendar\",\"title\":\"Delete Calendar\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a calendar permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the calendar and ALL events\\\\ncontained within it. This action cannot be undone.\\\\n\\\\nNote: The default calendar cannot be deleted.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    calendar_id: The calendar ID to delete\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If confirm is False.\\\\n    ValueError: If attempting to delete the default calendar.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"calendar_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"calendar_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Calendar\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_propose_new_time\",\"title\":\"Propose New Meeting Time\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Propose a new time for a meeting (requires user confirmation recommended)\\\\n\\\\nProposes a new meeting time to the organizer. This is useful when you\\'ve\\\\nbeen invited to a meeting but the time doesn\\'t work for you.\\\\n\\\\nNote: This only works for meetings where you are an attendee, not the organizer.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to propose new time for\\\\n    proposed_start: Proposed start time in ISO format (e.g., \\\\\"2024-01-15T10:00:00\\\\\")\\\\n    proposed_end: Proposed end time in ISO format\\\\n    message: Optional message explaining the proposed change\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If datetime values are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"proposed_start\":{\"type\":\"string\"},\"proposed_end\":{\"type\":\"string\"},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"event_id\",\"proposed_start\",\"proposed_end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Propose New Meeting Time\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_get_free_busy\",\"title\":\"Get Free/Busy Times\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get simplified free/busy times for attendees (read-only, safe for unsupervised use)\\\\n\\\\nReturns a simplified view of free/busy information for specified attendees.\\\\nThis is similar to calendar_check_availability but focuses on availability\\\\nview strings rather than detailed schedule information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    attendees: Email address(es) to check availability for\\\\n    start: Start time in ISO format\\\\n    end: End time in ISO format\\\\n    time_interval: Interval in minutes for availability view (default: 30)\\\\n\\\\nReturns:\\\\n    Free/busy information with availability view strings\\\\n\\\\nRaises:\\\\n    ValidationError: If start/end datetimes or attendee addresses are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"time_interval\":{\"default\":30,\"type\":\"integer\"}},\"required\":[\"account_id\",\"attendees\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Free/Busy Times\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_list\",\"title\":\"List Contacts\",\"description\":\"\\xf0\\x9f\\x93\\x96 List contacts (read-only, safe for unsupervised use)\\\\n\\\\nReturns contacts with names, email addresses, and phone numbers.\\\\n\\\\nCaching: Results are cached for 20 minutes (fresh) / 2 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum contacts to return (1-500, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of contact objects with metadata.\\\\n    Each contact includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Contacts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_get\",\"title\":\"Get Contact\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get contact details (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete contact information including all fields.\\\\n\\\\nCaching: Results are cached for 30 minutes (fresh) / 4 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    contact_id: The contact ID\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Contact details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"contact_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Contact\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_create\",\"title\":\"Create Contact\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new contact (requires user confirmation recommended)\\\\n\\\\nCreates a contact with name, email addresses, and phone numbers.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    given_name: First name (required)\\\\n    surname: Last name (optional)\\\\n    email_addresses: Email address(es) (optional)\\\\n    phone_numbers: Phone numbers dict with keys: business, home, mobile (optional)\\\\n\\\\nReturns:\\\\n    Created contact object with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"given_name\":{\"type\":\"string\"},\"surname\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"email_addresses\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"phone_numbers\":{\"anyOf\":[{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"given_name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Contact\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_update\",\"title\":\"Update Contact\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update contact information (requires user confirmation recommended)\\\\n\\\\nModifies contact fields like name, email, or phone numbers.\\\\n\\\\nAllowed update keys: givenName, surname, displayName, emailAddresses,\\\\nbusinessPhones, homePhones, mobilePhone, jobTitle, companyName, department.\\\\n\\\\nArgs:\\\\n    contact_id: The contact ID to update\\\\n    updates: Dictionary with fields to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated contact object\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"contact_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Contact\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_delete\",\"title\":\"Delete Contact\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a contact permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the contact and cannot be undone.\\\\n\\\\nArgs:\\\\n    contact_id: The contact to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"contact_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Contact\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_create_list\",\"title\":\"Create Contact List\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new contact list (requires user confirmation recommended)\\\\n\\\\nCreates a contact folder (list) for organizing contacts into groups.\\\\nUseful for creating distribution lists, project teams, or other groupings.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    list_name: Name for the contact list/folder\\\\n\\\\nReturns:\\\\n    Created contact folder object with ID\\\\n\\\\nRaises:\\\\n    ValidationError: If list name is empty or invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"list_name\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"list_name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Contact List\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_add_to_list\",\"title\":\"Add Contact to List\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add a contact to a contact list (requires user confirmation recommended)\\\\n\\\\nAdds an existing contact to a contact folder (list). The contact is copied\\\\nto the list, so it will exist in both the original location and the list.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    contact_id: The contact ID to add\\\\n    list_id: The contact list/folder ID\\\\n\\\\nReturns:\\\\n    Copy of the contact in the new list\\\\n\\\\nRaises:\\\\n    ValueError: If contact or list is not found.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"contact_id\":{\"type\":\"string\"},\"list_id\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"contact_id\",\"list_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Contact to List\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_export\",\"title\":\"Export Contact\",\"description\":\"\\xf0\\x9f\\x93\\x96 Export a contact in vCard format (read-only, safe for unsupervised use)\\\\n\\\\nExports contact information in vCard format for portability and sharing.\\\\nvCard is a standard format supported by most contact management applications.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    contact_id: The contact ID to export\\\\n    format: Export format (currently only \\\\\"vcard\\\\\" is supported)\\\\n\\\\nReturns:\\\\n    Dictionary containing the vCard data and metadata\\\\n\\\\nRaises:\\\\n    ValidationError: If format is not supported.\\\\n    ValueError: If contact is not found.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"contact_id\":{\"type\":\"string\"},\"format\":{\"default\":\"vcard\",\"type\":\"string\"}},\"required\":[\"account_id\",\"contact_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Export Contact\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_list\",\"title\":\"List Files\",\"description\":\"\\xf0\\x9f\\x93\\x96 List files and/or folders in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nReturns items from OneDrive with names, sizes, and modification dates.\\\\n\\\\nCaching: Results are cached for 10 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Path to list from (default: \\\\\"/\\\\\")\\\\n    folder_id: Direct folder ID (takes precedence over path)\\\\n    limit: Maximum items to return (1-500, default: 50)\\\\n    type_filter: Filter by type - \\\\\"all\\\\\", \\\\\"files\\\\\", or \\\\\"folders\\\\\" (default: \\\\\"all\\\\\")\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of items matching the filter criteria.\\\\n    Each item includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"type_filter\":{\"default\":\"all\",\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Files\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_get\",\"title\":\"Get File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Download a OneDrive file to a local path (requires user confirmation recommended)\\\\n\\\\nThe download URL is supplied by Microsoft Graph (never user input) and is\\\\nvalidated against an allow-list of Microsoft domains before use. The file\\\\nis streamed to disk in configurable chunks with retry behaviour to protect\\\\nagainst transient failures. Download size and timeouts respect the\\\\nenvironment variables `MCP_FILE_DOWNLOAD_MAX_MB` and\\\\n`MCP_FILE_DOWNLOAD_TIMEOUT`.\\\\n\\\\nArgs:\\\\n    file_id: The Microsoft Graph file identifier to download.\\\\n    account_id: Microsoft account identifier associated with the file.\\\\n    download_path: Absolute path where the file will be stored locally.\\\\n        Must reside within an allowed root directory.\\\\n\\\\nReturns:\\\\n    Dictionary containing download metadata (name, size_mb, mime_type).\\\\n\\\\nRaises:\\\\n    ValidationError: If input parameters are invalid.\\\\n    RuntimeError: If all download attempts fail.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"download_path\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\",\"download_path\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_create\",\"title\":\"Create File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Upload a local file to OneDrive (requires user confirmation recommended)\\\\n\\\\nArgs:\\\\n    onedrive_path: Destination path within OneDrive (must start with \\'/\\').\\\\n    local_file_path: Absolute path to the local file to upload. Paths are\\\\n        validated via `ensure_safe_path` to prevent traversal and\\\\n        restrict uploads to trusted directories.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Metadata for the created OneDrive file.\",\"inputSchema\":{\"properties\":{\"onedrive_path\":{\"type\":\"string\"},\"local_file_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"onedrive_path\",\"local_file_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_update\",\"title\":\"Update File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Replace OneDrive file content with local file (requires user confirmation recommended)\\\\n\\\\nArgs:\\\\n    file_id: Target OneDrive file identifier to replace.\\\\n    local_file_path: Absolute path to the replacement file. Validated via\\\\n        `ensure_safe_path` to block traversal and enforce workspace roots.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Updated file metadata returned by Microsoft Graph.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"local_file_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"local_file_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_delete\",\"title\":\"Delete File\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a OneDrive file or folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the file or folder and cannot be undone.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete File\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_copy\",\"title\":\"Copy File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Copy a file within OneDrive (requires user confirmation recommended)\\\\n\\\\nCreates a copy of a file in a specified destination folder. The copy\\\\noperation is asynchronous and may take time for large files.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to copy\\\\n    destination_folder_id: The destination folder ID\\\\n    account_id: Microsoft account ID\\\\n    new_name: Optional new name for the copied file\\\\n\\\\nReturns:\\\\n    Copy operation status with location URL to monitor progress\\\\n\\\\nRaises:\\\\n    ValueError: If file_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"new_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"file_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Copy File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_move\",\"title\":\"Move File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a file to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves a file to a different parent folder within OneDrive.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to move\\\\n    destination_folder_id: The destination folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated file object with new parentReference\\\\n\\\\nRaises:\\\\n    ValueError: If file_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_rename\",\"title\":\"Rename File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a file (requires user confirmation recommended)\\\\n\\\\nUpdates the name of an existing OneDrive file.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to rename\\\\n    new_name: New name for the file\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated file object with new name\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or new_name is empty\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"new_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"new_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_share\",\"title\":\"Share File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a sharing link for a OneDrive file (requires user confirmation recommended)\\\\n\\\\nCreates a sharing link that allows others to access the file. Permission types\\\\ncontrol what recipients can do with the file.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to share\\\\n    account_id: Microsoft account ID\\\\n    permission_type: Type of permission - \\\\\"view\\\\\" or \\\\\"edit\\\\\" (default: \\\\\"view\\\\\")\\\\n    scope: Link scope - \\\\\"anonymous\\\\\" or \\\\\"organization\\\\\" (default: \\\\\"anonymous\\\\\")\\\\n\\\\nReturns:\\\\n    Sharing link details including the web URL\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or permission_type/scope is unsupported\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"permission_type\":{\"default\":\"view\",\"type\":\"string\"},\"scope\":{\"default\":\"anonymous\",\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Share File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_download_url\",\"title\":\"Get File Download URL\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get direct download URL for a OneDrive file (read-only, safe for unsupervised use)\\\\n\\\\nReturns a temporary download URL that can be used to download the file directly\\\\nwithout authentication. The URL expires after a short period.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to get download URL for\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Dictionary containing the download URL and file metadata\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or file not found\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get File Download URL\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_list\",\"title\":\"List Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List only folders (not files) in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nReturns folders with child counts and hierarchy information.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Path to list folders from (e.g., \\\\\"/Documents\\\\\", default: \\\\\"/\\\\\")\\\\n    folder_id: Direct folder ID (takes precedence over path)\\\\n    limit: Maximum folders to return (1-500, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Dictionary with:\\\\n    - folders: List of folder objects with id, name, childCount, path, parentId\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"List Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_get\",\"title\":\"Get Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get metadata for a specific OneDrive folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns folder details including child count and web URL.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder_id: Folder ID (takes precedence if provided)\\\\n    path: Folder path (e.g., \\\\\"/Documents/Projects\\\\\")\\\\n\\\\nReturns:\\\\n    Folder metadata including childCount, webUrl, and parent info\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"path\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_get_tree\",\"title\":\"Get Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of OneDrive folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and nested subfolders.\\\\nUseful for understanding OneDrive folder organization.\\\\n\\\\nCaching: Results are cached for 30 minutes (fresh) / 2 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Starting path (default: \\\\\"/\\\\\")\\\\n    folder_id: Starting folder ID (takes precedence over path)\\\\n    max_depth: Maximum recursion depth (1-25, default: 10)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children, including:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_create\",\"title\":\"Create OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new OneDrive folder (requires user confirmation recommended)\\\\n\\\\nCreates a new folder in OneDrive, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, name, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_delete\",\"title\":\"Delete OneDrive Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an OneDrive folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(files and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_rename\",\"title\":\"Rename OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename an OneDrive folder (requires user confirmation recommended)\\\\n\\\\nUpdates the name of an existing OneDrive folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new name\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_move\",\"title\":\"Move OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an OneDrive folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentReference\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_files\",\"title\":\"Search Files\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search for files in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nSearches file names and content across all accessible OneDrive folders.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OneDrive-specific search\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching files with metadata\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Files\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_emails\",\"title\":\"Search Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search emails across mailbox (read-only, safe for unsupervised use)\\\\n\\\\nSearches email subject, body, and sender across all or specific folders.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OData $search parameter\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    folder: Optional folder to search within (e.g., \\\\\"inbox\\\\\", \\\\\"sent\\\\\")\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching emails with metadata\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_events\",\"title\":\"Search Events\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search calendar events (read-only, safe for unsupervised use)\\\\n\\\\nSearches event titles, locations, and descriptions within date range.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OData $search parameter\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    days_ahead: Days to look forward (0-730, default: 365)\\\\n    days_back: Days to look back (0-730, default: 365)\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching events\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"days_ahead\":{\"default\":365,\"type\":\"integer\"},\"days_back\":{\"default\":365,\"type\":\"integer\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Events\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_contacts\",\"title\":\"Search Contacts\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search contacts (read-only, safe for unsupervised use)\\\\n\\\\nSearches contact names, email addresses, and phone numbers.\\\\nUses $filter with prefix matching (startswith) for all account types\\\\ndue to Graph API limitations.\\\\n\\\\nNote: Contact search is limited to prefix matching and may not find\\\\nmatches in the middle of names.\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters, used as prefix)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching contacts\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Contacts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_unified\",\"title\":\"Unified Search\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search across multiple Microsoft 365 resources (read-only, safe for unsupervised use)\\\\n\\\\nSearches emails, events, and files simultaneously.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Performs sequential searches for each entity type\\\\n- Work/school accounts: Uses unified search API for parallel search\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    entity_types: Types to search: \\'message\\', \\'event\\', \\'driveItem\\' (default: all)\\\\n    limit: Maximum results per type (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    Dictionary with results grouped by entity type\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"entity_types\":{\"anyOf\":[{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Unified Search\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"server_get_version\",\"title\":\"Get Server Version\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get the version of the m365-mcp server (read-only, safe for unsupervised use)\\\\n\\\\nReturns the current version of the m365-mcp server that is running.\\\\nUseful for diagnostics, troubleshooting, and ensuring compatibility.\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - version: The semantic version string (e.g., \\\\\"0.1.3\\\\\")\\\\n    - package: The package name (\\\\\"m365-mcp\\\\\")\\\\n\\\\nExample:\\\\n    >>> server_get_version()\\\\n    {\\\\\"version\\\\\": \\\\\"0.1.3\\\\\", \\\\\"package\\\\\": \\\\\"m365-mcp\\\\\"}\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Get Server Version\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"server\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-19T16:51:30.793027+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:51:30.798740+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:30.798783+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: dad568d5bcc544dd93f9a1429a022c8d", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-19T16:51:30.799017+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-19T16:51:30.799270+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:51:57.152113+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-19T16:51:57.152233+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: c4dd8af5cb4741518e639bcf8ada1025", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-19T16:51:57.154047+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-19T16:51:57.154096+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-19T16:51:57.154228+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:51:57.155851+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:57.156176+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:57.156523+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-19T16:51:57.157064+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:57.157518+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7a1719094140>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-19T16:51:57.157596+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-19T16:51:57.157680+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-19T16:51:57.158924+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-19T16:51:57.159573+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-19T16:51:57.160621+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"account_list\",\"title\":\"List Accounts\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all signed-in Microsoft accounts (read-only, safe for unsupervised use)\\\\n\\\\nReturns a list of authenticated Microsoft accounts with their usernames, account IDs,\\\\nand account types (personal or work/school).\\\\n\\\\nReturns:\\\\n    List of account dictionaries with:\\\\n    - username: Account email/username\\\\n    - account_id: Unique account identifier\\\\n    - account_type: \\\\\"personal\\\\\", \\\\\"work_school\\\\\", or \\\\\"unknown\\\\\"\\\\n\\\\nExample:\\\\n    [\\\\n        {\\\\n            \\\\\"username\\\\\": \\\\\"user@outlook.com\\\\\",\\\\n            \\\\\"account_id\\\\\": \\\\\"abc123...\\\\\",\\\\n            \\\\\"account_type\\\\\": \\\\\"personal\\\\\"\\\\n        },\\\\n        {\\\\n            \\\\\"username\\\\\": \\\\\"user@contoso.com\\\\\",\\\\n            \\\\\"account_id\\\\\": \\\\\"def456...\\\\\",\\\\n            \\\\\"account_type\\\\\": \\\\\"work_school\\\\\"\\\\n        }\\\\n    ]\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Accounts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"account_authenticate\",\"title\":\"Authenticate Account\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Authenticate a new Microsoft account using device flow (requires user confirmation recommended)\\\\n\\\\nInitiates device flow authentication for adding a new Microsoft account.\\\\nReturns authentication instructions with a device code and verification URL.\\\\n\\\\nThe user must:\\\\n1. Visit the verification URL\\\\n2. Enter the device code\\\\n3. Sign in with their Microsoft account\\\\n4. Use account_complete_auth to finish the process\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Authenticate Account\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"account_complete_auth\",\"title\":\"Complete Authentication\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Complete device flow authentication (requires user confirmation recommended)\\\\n\\\\nCompletes the authentication process after the user has entered the device code\\\\nat the verification URL.\\\\n\\\\nArgs:\\\\n    flow_cache: The flow data returned from account_authenticate (the _flow_cache field)\\\\n\\\\nReturns:\\\\n    Account information if authentication was successful, or pending status if\\\\n    the user hasn\\'t completed authentication yet.\",\"inputSchema\":{\"properties\":{\"flow_cache\":{\"type\":\"string\"}},\"required\":[\"flow_cache\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Complete Authentication\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_list_events\",\"title\":\"List Calendar Events\",\"description\":\"\\xf0\\x9f\\x93\\x96 List upcoming calendar events (read-only, safe for unsupervised use)\\\\n\\\\nReturns calendar events from now until the specified number of days ahead.\\\\n\\\\nCaching: Results are cached for 5 minutes (fresh) / 30 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    days_ahead: Number of days ahead to look for events (1-365, default: 7)\\\\n    include_details: Include full event details like attendees and body (default: False)\\\\n    limit: Maximum events to return (1-200, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of calendar events with metadata.\\\\n    Each event includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"days_ahead\":{\"default\":7,\"type\":\"integer\"},\"include_details\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Calendar Events\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_get_event\",\"title\":\"Get Calendar Event\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get full event details (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete event information including recurrence patterns and online meeting details.\\\\n\\\\nArgs:\\\\n    event_id: The event ID\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    Complete event object with all metadata\",\"inputSchema\":{\"properties\":{\"event_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"event_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Calendar Event\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_create_event\",\"title\":\"Create Calendar Event\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a calendar event (requires user confirmation recommended)\\\\n\\\\nCreates a new calendar event with optional attendees and location.\\\\nAttendees will receive meeting invitations. Addresses are validated,\\\\ndeduplicated, and limited to 500 unique recipients.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    subject: Event title\\\\n    start: Start time in ISO format (e.g., \\\\\"2024-01-15T10:00:00\\\\\")\\\\n    end: End time in ISO format\\\\n    location: Location name (optional)\\\\n    body: Event description (optional)\\\\n    attendees: Email address(es) of attendees (optional)\\\\n    timezone: Timezone for the event (default: \\\\\"UTC\\\\\")\\\\n\\\\nReturns:\\\\n    Created event object with ID\\\\n\\\\nRaises:\\\\n    ValidationError: If datetime values, timezone, or attendee\\\\n        addresses are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"subject\":{\"type\":\"string\"},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"location\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"timezone\":{\"default\":\"UTC\",\"type\":\"string\"}},\"required\":[\"account_id\",\"subject\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_update_event\",\"title\":\"Update Calendar Event\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update event properties (requires user confirmation recommended)\\\\n\\\\nModifies event details like time, location, or attendees.\\\\nAttendees will receive update notifications.\\\\n\\\\nAllowed update keys: subject, start, end, timezone, location, body, attendees.\\\\n\\\\nArgs:\\\\n    event_id: The event ID to update\\\\n    updates: Dictionary with fields to update (subject, start, end, location, body)\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated event object\",\"inputSchema\":{\"properties\":{\"event_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"event_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_delete_event\",\"title\":\"Delete Calendar Event\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a calendar event (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the event and cannot be undone.\\\\nIf this is a meeting, attendees will receive cancellation notices.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event to delete\\\\n    send_cancellation: Whether to notify attendees (default: True)\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"send_cancellation\":{\"default\":true,\"type\":\"boolean\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"event_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_respond_event\",\"title\":\"Respond to Calendar Event\",\"description\":\"\\xe2\\x9a\\xa0\\xef\\xb8\\x8f Respond to a calendar event invitation (requires user confirmation recommended)\\\\n\\\\nIMPORTANT: This sends a response to the event organizer.\\\\n\\\\nValid responses:\\\\n    - \\\\\"accept\\\\\" - Accept the invitation\\\\n    - \\\\\"decline\\\\\" - Decline the invitation\\\\n    - \\\\\"tentativelyAccept\\\\\" - Mark as tentative\\\\n  (Input is case-insensitive; \\\\\"tentative\\\\\" is accepted as an alias.)\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to respond to\\\\n    response: Response type (default: \\\\\"accept\\\\\")\\\\n    message: Optional message to the organizer\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the response value or message payload is invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"response\":{\"default\":\"accept\",\"type\":\"string\"},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"event_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Respond to Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_check_availability\",\"title\":\"Check Calendar Availability\",\"description\":\"\\xf0\\x9f\\x93\\x96 Check calendar availability for scheduling (read-only, safe for unsupervised use)\\\\n\\\\nReturns free/busy information for the user and optional attendees.\\\\nUseful for finding meeting times.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    start: Start time in ISO format\\\\n    end: End time in ISO format\\\\n    attendees: Optional email address(es) to check availability\\\\n\\\\nReturns:\\\\n    Schedule information with free/busy slots\\\\n\\\\nRaises:\\\\n    ValidationError: If start/end datetimes or attendee addresses\\\\n        are invalid.\\\\n    ValueError: If the current account email address is unavailable.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Check Calendar Availability\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_forward_event\",\"title\":\"Forward Calendar Event\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward a calendar event to recipients (always require user confirmation)\\\\n\\\\nWARNING: Meeting invitation will be sent immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    message: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"event_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_list_calendars\",\"title\":\"List Calendars\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all available calendars (read-only, safe for unsupervised use)\\\\n\\\\nReturns all calendars accessible by the user, including primary calendar\\\\nand any additional calendars (shared, group, etc.).\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of calendar objects with metadata.\\\\n    Each calendar includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Calendars\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_create_calendar\",\"title\":\"Create Calendar\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new calendar (requires user confirmation recommended)\\\\n\\\\nCreates a new calendar in the user\\'s mailbox. Useful for organizing\\\\nevents into separate calendars (work, personal, project-specific, etc.).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    name: Name for the new calendar\\\\n\\\\nReturns:\\\\n    Created calendar object with ID and metadata\\\\n\\\\nRaises:\\\\n    ValidationError: If calendar name is empty or invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Calendar\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_delete_calendar\",\"title\":\"Delete Calendar\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a calendar permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the calendar and ALL events\\\\ncontained within it. This action cannot be undone.\\\\n\\\\nNote: The default calendar cannot be deleted.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    calendar_id: The calendar ID to delete\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If confirm is False.\\\\n    ValueError: If attempting to delete the default calendar.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"calendar_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"calendar_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Calendar\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_propose_new_time\",\"title\":\"Propose New Meeting Time\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Propose a new time for a meeting (requires user confirmation recommended)\\\\n\\\\nProposes a new meeting time to the organizer. This is useful when you\\'ve\\\\nbeen invited to a meeting but the time doesn\\'t work for you.\\\\n\\\\nNote: This only works for meetings where you are an attendee, not the organizer.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to propose new time for\\\\n    proposed_start: Proposed start time in ISO format (e.g., \\\\\"2024-01-15T10:00:00\\\\\")\\\\n    proposed_end: Proposed end time in ISO format\\\\n    message: Optional message explaining the proposed change\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If datetime values are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"proposed_start\":{\"type\":\"string\"},\"proposed_end\":{\"type\":\"string\"},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"event_id\",\"proposed_start\",\"proposed_end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Propose New Meeting Time\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_get_free_busy\",\"title\":\"Get Free/Busy Times\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get simplified free/busy times for attendees (read-only, safe for unsupervised use)\\\\n\\\\nReturns a simplified view of free/busy information for specified attendees.\\\\nThis is similar to calendar_check_availability but focuses on availability\\\\nview strings rather than detailed schedule information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    attendees: Email address(es) to check availability for\\\\n    start: Start time in ISO format\\\\n    end: End time in ISO format\\\\n    time_interval: Interval in minutes for availability view (default: 30)\\\\n\\\\nReturns:\\\\n    Free/busy information with availability view strings\\\\n\\\\nRaises:\\\\n    ValidationError: If start/end datetimes or attendee addresses are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"time_interval\":{\"default\":30,\"type\":\"integer\"}},\"required\":[\"account_id\",\"attendees\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Free/Busy Times\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_list\",\"title\":\"List Contacts\",\"description\":\"\\xf0\\x9f\\x93\\x96 List contacts (read-only, safe for unsupervised use)\\\\n\\\\nReturns contacts with names, email addresses, and phone numbers.\\\\n\\\\nCaching: Results are cached for 20 minutes (fresh) / 2 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum contacts to return (1-500, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of contact objects with metadata.\\\\n    Each contact includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Contacts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_get\",\"title\":\"Get Contact\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get contact details (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete contact information including all fields.\\\\n\\\\nCaching: Results are cached for 30 minutes (fresh) / 4 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    contact_id: The contact ID\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Contact details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"contact_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Contact\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_create\",\"title\":\"Create Contact\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new contact (requires user confirmation recommended)\\\\n\\\\nCreates a contact with name, email addresses, and phone numbers.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    given_name: First name (required)\\\\n    surname: Last name (optional)\\\\n    email_addresses: Email address(es) (optional)\\\\n    phone_numbers: Phone numbers dict with keys: business, home, mobile (optional)\\\\n\\\\nReturns:\\\\n    Created contact object with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"given_name\":{\"type\":\"string\"},\"surname\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"email_addresses\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"phone_numbers\":{\"anyOf\":[{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"given_name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Contact\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_update\",\"title\":\"Update Contact\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update contact information (requires user confirmation recommended)\\\\n\\\\nModifies contact fields like name, email, or phone numbers.\\\\n\\\\nAllowed update keys: givenName, surname, displayName, emailAddresses,\\\\nbusinessPhones, homePhones, mobilePhone, jobTitle, companyName, department.\\\\n\\\\nArgs:\\\\n    contact_id: The contact ID to update\\\\n    updates: Dictionary with fields to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated contact object\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"contact_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Contact\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_delete\",\"title\":\"Delete Contact\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a contact permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the contact and cannot be undone.\\\\n\\\\nArgs:\\\\n    contact_id: The contact to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"contact_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Contact\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_create_list\",\"title\":\"Create Contact List\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new contact list (requires user confirmation recommended)\\\\n\\\\nCreates a contact folder (list) for organizing contacts into groups.\\\\nUseful for creating distribution lists, project teams, or other groupings.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    list_name: Name for the contact list/folder\\\\n\\\\nReturns:\\\\n    Created contact folder object with ID\\\\n\\\\nRaises:\\\\n    ValidationError: If list name is empty or invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"list_name\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"list_name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Contact List\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_add_to_list\",\"title\":\"Add Contact to List\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add a contact to a contact list (requires user confirmation recommended)\\\\n\\\\nAdds an existing contact to a contact folder (list). The contact is copied\\\\nto the list, so it will exist in both the original location and the list.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    contact_id: The contact ID to add\\\\n    list_id: The contact list/folder ID\\\\n\\\\nReturns:\\\\n    Copy of the contact in the new list\\\\n\\\\nRaises:\\\\n    ValueError: If contact or list is not found.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"contact_id\":{\"type\":\"string\"},\"list_id\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"contact_id\",\"list_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Contact to List\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_export\",\"title\":\"Export Contact\",\"description\":\"\\xf0\\x9f\\x93\\x96 Export a contact in vCard format (read-only, safe for unsupervised use)\\\\n\\\\nExports contact information in vCard format for portability and sharing.\\\\nvCard is a standard format supported by most contact management applications.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    contact_id: The contact ID to export\\\\n    format: Export format (currently only \\\\\"vcard\\\\\" is supported)\\\\n\\\\nReturns:\\\\n    Dictionary containing the vCard data and metadata\\\\n\\\\nRaises:\\\\n    ValidationError: If format is not supported.\\\\n    ValueError: If contact is not found.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"contact_id\":{\"type\":\"string\"},\"format\":{\"default\":\"vcard\",\"type\":\"string\"}},\"required\":[\"account_id\",\"contact_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Export Contact\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_list\",\"title\":\"List Files\",\"description\":\"\\xf0\\x9f\\x93\\x96 List files and/or folders in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nReturns items from OneDrive with names, sizes, and modification dates.\\\\n\\\\nCaching: Results are cached for 10 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Path to list from (default: \\\\\"/\\\\\")\\\\n    folder_id: Direct folder ID (takes precedence over path)\\\\n    limit: Maximum items to return (1-500, default: 50)\\\\n    type_filter: Filter by type - \\\\\"all\\\\\", \\\\\"files\\\\\", or \\\\\"folders\\\\\" (default: \\\\\"all\\\\\")\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of items matching the filter criteria.\\\\n    Each item includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"type_filter\":{\"default\":\"all\",\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Files\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_get\",\"title\":\"Get File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Download a OneDrive file to a local path (requires user confirmation recommended)\\\\n\\\\nThe download URL is supplied by Microsoft Graph (never user input) and is\\\\nvalidated against an allow-list of Microsoft domains before use. The file\\\\nis streamed to disk in configurable chunks with retry behaviour to protect\\\\nagainst transient failures. Download size and timeouts respect the\\\\nenvironment variables `MCP_FILE_DOWNLOAD_MAX_MB` and\\\\n`MCP_FILE_DOWNLOAD_TIMEOUT`.\\\\n\\\\nArgs:\\\\n    file_id: The Microsoft Graph file identifier to download.\\\\n    account_id: Microsoft account identifier associated with the file.\\\\n    download_path: Absolute path where the file will be stored locally.\\\\n        Must reside within an allowed root directory.\\\\n\\\\nReturns:\\\\n    Dictionary containing download metadata (name, size_mb, mime_type).\\\\n\\\\nRaises:\\\\n    ValidationError: If input parameters are invalid.\\\\n    RuntimeError: If all download attempts fail.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"download_path\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\",\"download_path\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_create\",\"title\":\"Create File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Upload a local file to OneDrive (requires user confirmation recommended)\\\\n\\\\nArgs:\\\\n    onedrive_path: Destination path within OneDrive (must start with \\'/\\').\\\\n    local_file_path: Absolute path to the local file to upload. Paths are\\\\n        validated via `ensure_safe_path` to prevent traversal and\\\\n        restrict uploads to trusted directories.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Metadata for the created OneDrive file.\",\"inputSchema\":{\"properties\":{\"onedrive_path\":{\"type\":\"string\"},\"local_file_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"onedrive_path\",\"local_file_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_update\",\"title\":\"Update File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Replace OneDrive file content with local file (requires user confirmation recommended)\\\\n\\\\nArgs:\\\\n    file_id: Target OneDrive file identifier to replace.\\\\n    local_file_path: Absolute path to the replacement file. Validated via\\\\n        `ensure_safe_path` to block traversal and enforce workspace roots.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Updated file metadata returned by Microsoft Graph.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"local_file_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"local_file_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_delete\",\"title\":\"Delete File\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a OneDrive file or folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the file or folder and cannot be undone.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete File\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_copy\",\"title\":\"Copy File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Copy a file within OneDrive (requires user confirmation recommended)\\\\n\\\\nCreates a copy of a file in a specified destination folder. The copy\\\\noperation is asynchronous and may take time for large files.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to copy\\\\n    destination_folder_id: The destination folder ID\\\\n    account_id: Microsoft account ID\\\\n    new_name: Optional new name for the copied file\\\\n\\\\nReturns:\\\\n    Copy operation status with location URL to monitor progress\\\\n\\\\nRaises:\\\\n    ValueError: If file_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"new_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"file_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Copy File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_move\",\"title\":\"Move File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a file to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves a file to a different parent folder within OneDrive.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to move\\\\n    destination_folder_id: The destination folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated file object with new parentReference\\\\n\\\\nRaises:\\\\n    ValueError: If file_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_rename\",\"title\":\"Rename File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a file (requires user confirmation recommended)\\\\n\\\\nUpdates the name of an existing OneDrive file.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to rename\\\\n    new_name: New name for the file\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated file object with new name\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or new_name is empty\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"new_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"new_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_share\",\"title\":\"Share File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a sharing link for a OneDrive file (requires user confirmation recommended)\\\\n\\\\nCreates a sharing link that allows others to access the file. Permission types\\\\ncontrol what recipients can do with the file.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to share\\\\n    account_id: Microsoft account ID\\\\n    permission_type: Type of permission - \\\\\"view\\\\\" or \\\\\"edit\\\\\" (default: \\\\\"view\\\\\")\\\\n    scope: Link scope - \\\\\"anonymous\\\\\" or \\\\\"organization\\\\\" (default: \\\\\"anonymous\\\\\")\\\\n\\\\nReturns:\\\\n    Sharing link details including the web URL\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or permission_type/scope is unsupported\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"permission_type\":{\"default\":\"view\",\"type\":\"string\"},\"scope\":{\"default\":\"anonymous\",\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Share File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_download_url\",\"title\":\"Get File Download URL\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get direct download URL for a OneDrive file (read-only, safe for unsupervised use)\\\\n\\\\nReturns a temporary download URL that can be used to download the file directly\\\\nwithout authentication. The URL expires after a short period.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to get download URL for\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Dictionary containing the download URL and file metadata\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or file not found\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get File Download URL\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_list\",\"title\":\"List Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List only folders (not files) in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nReturns folders with child counts and hierarchy information.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Path to list folders from (e.g., \\\\\"/Documents\\\\\", default: \\\\\"/\\\\\")\\\\n    folder_id: Direct folder ID (takes precedence over path)\\\\n    limit: Maximum folders to return (1-500, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Dictionary with:\\\\n    - folders: List of folder objects with id, name, childCount, path, parentId\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"List Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_get\",\"title\":\"Get Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get metadata for a specific OneDrive folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns folder details including child count and web URL.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder_id: Folder ID (takes precedence if provided)\\\\n    path: Folder path (e.g., \\\\\"/Documents/Projects\\\\\")\\\\n\\\\nReturns:\\\\n    Folder metadata including childCount, webUrl, and parent info\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"path\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_get_tree\",\"title\":\"Get Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of OneDrive folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and nested subfolders.\\\\nUseful for understanding OneDrive folder organization.\\\\n\\\\nCaching: Results are cached for 30 minutes (fresh) / 2 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Starting path (default: \\\\\"/\\\\\")\\\\n    folder_id: Starting folder ID (takes precedence over path)\\\\n    max_depth: Maximum recursion depth (1-25, default: 10)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children, including:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_create\",\"title\":\"Create OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new OneDrive folder (requires user confirmation recommended)\\\\n\\\\nCreates a new folder in OneDrive, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, name, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_delete\",\"title\":\"Delete OneDrive Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an OneDrive folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(files and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_rename\",\"title\":\"Rename OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename an OneDrive folder (requires user confirmation recommended)\\\\n\\\\nUpdates the name of an existing OneDrive folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new name\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_move\",\"title\":\"Move OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an OneDrive folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentReference\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_files\",\"title\":\"Search Files\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search for files in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nSearches file names and content across all accessible OneDrive folders.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OneDrive-specific search\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching files with metadata\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Files\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_emails\",\"title\":\"Search Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search emails across mailbox (read-only, safe for unsupervised use)\\\\n\\\\nSearches email subject, body, and sender across all or specific folders.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OData $search parameter\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    folder: Optional folder to search within (e.g., \\\\\"inbox\\\\\", \\\\\"sent\\\\\")\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching emails with metadata\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_events\",\"title\":\"Search Events\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search calendar events (read-only, safe for unsupervised use)\\\\n\\\\nSearches event titles, locations, and descriptions within date range.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OData $search parameter\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    days_ahead: Days to look forward (0-730, default: 365)\\\\n    days_back: Days to look back (0-730, default: 365)\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching events\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"days_ahead\":{\"default\":365,\"type\":\"integer\"},\"days_back\":{\"default\":365,\"type\":\"integer\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Events\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_contacts\",\"title\":\"Search Contacts\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search contacts (read-only, safe for unsupervised use)\\\\n\\\\nSearches contact names, email addresses, and phone numbers.\\\\nUses $filter with prefix matching (startswith) for all account types\\\\ndue to Graph API limitations.\\\\n\\\\nNote: Contact search is limited to prefix matching and may not find\\\\nmatches in the middle of names.\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters, used as prefix)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching contacts\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Contacts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_unified\",\"title\":\"Unified Search\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search across multiple Microsoft 365 resources (read-only, safe for unsupervised use)\\\\n\\\\nSearches emails, events, and files simultaneously.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Performs sequential searches for each entity type\\\\n- Work/school accounts: Uses unified search API for parallel search\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    entity_types: Types to search: \\'message\\', \\'event\\', \\'driveItem\\' (default: all)\\\\n    limit: Maximum results per type (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    Dictionary with results grouped by entity type\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"entity_types\":{\"anyOf\":[{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Unified Search\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"server_get_version\",\"title\":\"Get Server Version\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get the version of the m365-mcp server (read-only, safe for unsupervised use)\\\\n\\\\nReturns the current version of the m365-mcp server that is running.\\\\nUseful for diagnostics, troubleshooting, and ensuring compatibility.\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - version: The semantic version string (e.g., \\\\\"0.1.3\\\\\")\\\\n    - package: The package name (\\\\\"m365-mcp\\\\\")\\\\n\\\\nExample:\\\\n    >>> server_get_version()\\\\n    {\\\\\"version\\\\\": \\\\\"0.1.3\\\\\", \\\\\"package\\\\\": \\\\\"m365-mcp\\\\\"}\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Get Server Version\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"server\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-19T16:51:57.161260+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:51:57.165997+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:51:57.166039+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: c4dd8af5cb4741518e639bcf8ada1025", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-19T16:51:57.166244+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-19T16:51:57.166499+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:52:51.354248+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Creating new transport", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 221}
{"timestamp": "2025-11-19T16:52:51.354370+00:00", "level": "INFO", "logger": "mcp.server.streamable_http_manager", "message": "Created new transport with session ID: df148abdfd0843a1ba56ab1d20250780", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 233}
{"timestamp": "2025-11-19T16:52:51.356201+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-19T16:52:51.356277+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":0,\"result\":{\"protocolVersion\":\"2025-06-18\",\"capabilities\":{\"experimental\":{},\"prompts\":{\"listChanged\":true},\"resources\":{\"subscribe\":false,\"listChanged\":true},\"tools\":{\"listChanged\":true}},\"serverInfo\":{\"name\":\"microsoft-mcp\",\"version\":\"1.17.0\"}}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-19T16:52:51.356458+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:52:51.357769+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:52:51.358154+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:52:51.358697+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-19T16:52:51.359345+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:52:51.359780+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Received message: <mcp.shared.session.RequestResponder object at 0x7a1718f1bf50>", "module": "server", "function": "run", "line": 627}
{"timestamp": "2025-11-19T16:52:51.359865+00:00", "level": "INFO", "logger": "mcp.server.lowlevel.server", "message": "Processing request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 664}
{"timestamp": "2025-11-19T16:52:51.359925+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Dispatching request of type ListToolsRequest", "module": "server", "function": "_handle_request", "line": 666}
{"timestamp": "2025-11-19T16:52:51.360899+00:00", "level": "DEBUG", "logger": "mcp.server.lowlevel.server", "message": "Response sent", "module": "server", "function": "_handle_request", "line": 713}
{"timestamp": "2025-11-19T16:52:51.361541+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing SSE writer", "module": "streamable_http", "function": "sse_writer", "line": 463}
{"timestamp": "2025-11-19T16:52:51.362559+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "chunk: b'event: message\\r\\ndata: {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[{\"name\":\"account_list\",\"title\":\"List Accounts\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all signed-in Microsoft accounts (read-only, safe for unsupervised use)\\\\n\\\\nReturns a list of authenticated Microsoft accounts with their usernames, account IDs,\\\\nand account types (personal or work/school).\\\\n\\\\nReturns:\\\\n    List of account dictionaries with:\\\\n    - username: Account email/username\\\\n    - account_id: Unique account identifier\\\\n    - account_type: \\\\\"personal\\\\\", \\\\\"work_school\\\\\", or \\\\\"unknown\\\\\"\\\\n\\\\nExample:\\\\n    [\\\\n        {\\\\n            \\\\\"username\\\\\": \\\\\"user@outlook.com\\\\\",\\\\n            \\\\\"account_id\\\\\": \\\\\"abc123...\\\\\",\\\\n            \\\\\"account_type\\\\\": \\\\\"personal\\\\\"\\\\n        },\\\\n        {\\\\n            \\\\\"username\\\\\": \\\\\"user@contoso.com\\\\\",\\\\n            \\\\\"account_id\\\\\": \\\\\"def456...\\\\\",\\\\n            \\\\\"account_type\\\\\": \\\\\"work_school\\\\\"\\\\n        }\\\\n    ]\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Accounts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"account_authenticate\",\"title\":\"Authenticate Account\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Authenticate a new Microsoft account using device flow (requires user confirmation recommended)\\\\n\\\\nInitiates device flow authentication for adding a new Microsoft account.\\\\nReturns authentication instructions with a device code and verification URL.\\\\n\\\\nThe user must:\\\\n1. Visit the verification URL\\\\n2. Enter the device code\\\\n3. Sign in with their Microsoft account\\\\n4. Use account_complete_auth to finish the process\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Authenticate Account\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"account_complete_auth\",\"title\":\"Complete Authentication\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Complete device flow authentication (requires user confirmation recommended)\\\\n\\\\nCompletes the authentication process after the user has entered the device code\\\\nat the verification URL.\\\\n\\\\nArgs:\\\\n    flow_cache: The flow data returned from account_authenticate (the _flow_cache field)\\\\n\\\\nReturns:\\\\n    Account information if authentication was successful, or pending status if\\\\n    the user hasn\\'t completed authentication yet.\",\"inputSchema\":{\"properties\":{\"flow_cache\":{\"type\":\"string\"}},\"required\":[\"flow_cache\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Complete Authentication\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"account\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_get_status\",\"title\":\"Get Cache Task Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get status of a background cache task (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status, progress, and result/error information for a\\\\nspecific background cache task.\\\\n\\\\nArgs:\\\\n    task_id: The unique identifier for the cache task.\\\\n\\\\nReturns:\\\\n    Dictionary containing task status information:\\\\n    - task_id: Task identifier\\\\n    - status: Current status (queued, running, completed, failed)\\\\n    - operation: Operation type (e.g., folder_get_tree, email_list)\\\\n    - account_id: Associated account\\\\n    - progress: Progress percentage (0-100)\\\\n    - created_at: Task creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - result: Operation result (if completed)\\\\n    - error: Error message (if failed)\\\\n    - retry_count: Number of retries attempted\\\\n\\\\nRaises:\\\\n    ValueError: If task_id is not found.\",\"inputSchema\":{\"properties\":{\"task_id\":{\"type\":\"string\"}},\"required\":[\"task_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Task Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_task_list\",\"title\":\"List Cache Tasks\",\"description\":\"\\xf0\\x9f\\x93\\x96 List background cache tasks (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve a list of background cache tasks, optionally filtered by account\\\\nand status.\\\\n\\\\nArgs:\\\\n    account_id: Optional account ID to filter tasks (None = all accounts).\\\\n    status: Optional status filter (queued, running, completed, failed).\\\\n    limit: Maximum number of tasks to return (default: 50).\\\\n\\\\nReturns:\\\\n    List of task dictionaries, each containing:\\\\n    - task_id: Task identifier\\\\n    - status: Current status\\\\n    - operation: Operation type\\\\n    - account_id: Associated account\\\\n    - priority: Task priority (1=highest, 10=lowest)\\\\n    - created_at: Creation timestamp\\\\n    - updated_at: Last update timestamp\\\\n    - retry_count: Number of retries\\\\n\\\\nExample:\\\\n    # List all tasks for a specific account\\\\n    tasks = cache_task_list(account_id=\\\\\"user@example.com\\\\\")\\\\n\\\\n    # List only failed tasks\\\\n    failed = cache_task_list(status=\\\\\"failed\\\\\")\\\\n\\\\n    # List recent queued tasks\\\\n    queued = cache_task_list(status=\\\\\"queued\\\\\", limit=10)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"status\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"}},\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Cache Tasks\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_get_stats\",\"title\":\"Get Cache Statistics\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache statistics and performance metrics (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve comprehensive statistics about the cache system including size,\\\\nhit rates, entry counts, and performance metrics.\\\\n\\\\nReturns:\\\\n    Dictionary containing cache statistics:\\\\n    - total_entries: Total number of cached entries\\\\n    - total_size_bytes: Total size of cache in bytes\\\\n    - total_size_mb: Total size in megabytes\\\\n    - size_percentage: Percentage of max cache size used\\\\n    - hit_count: Number of cache hits\\\\n    - miss_count: Number of cache misses\\\\n    - hit_rate: Cache hit rate (0.0-1.0)\\\\n    - entries_by_resource_type: Count of entries per resource type\\\\n    - average_entry_size_bytes: Average size per entry\\\\n    - compressed_entries: Number of compressed entries\\\\n    - compression_ratio: Average compression ratio\\\\n    - oldest_entry_age_hours: Age of oldest entry in hours\\\\n    - cleanup_triggered: Whether cleanup threshold has been reached\\\\n    - last_cleanup: Timestamp of last cleanup operation\\\\n\\\\nExample:\\\\n    stats = cache_get_stats()\\\\n    print(f\\\\\"Cache hit rate: {stats[\\'hit_rate\\']:.2%}\\\\\")\\\\n    print(f\\\\\"Cache size: {stats[\\'total_size_mb\\']:.2f} MB\\\\\")\\\\n    print(f\\\\\"Size used: {stats[\\'size_percentage\\']:.1f}%\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Statistics\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_invalidate\",\"title\":\"Invalidate Cache Entries\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Invalidate cache entries matching a pattern (requires user confirmation recommended)\\\\n\\\\nDelete cache entries that match the specified pattern. This is useful for\\\\nforcing fresh data retrieval or clearing stale cache entries.\\\\n\\\\nArgs:\\\\n    pattern: Pattern to match cache keys (supports wildcards):\\\\n            - \\\\\"*\\\\\" matches any characters within a segment\\\\n            - Use \\\\\"email_list:*\\\\\" to invalidate all email lists\\\\n            - Use \\\\\"email_list:account@example.com:*\\\\\" for specific account\\\\n            - Use \\\\\"folder_get_tree:*\\\\\" to invalidate all folder trees\\\\n    account_id: Optional account ID to scope invalidation (None = all accounts).\\\\n    reason: Reason for invalidation (for audit logging).\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - entries_deleted: Number of cache entries deleted\\\\n    - pattern: Pattern that was used\\\\n    - account_id: Account ID filter (if specified)\\\\n    - reason: Invalidation reason\\\\n    - timestamp: When invalidation occurred\\\\n\\\\nExamples:\\\\n    # Invalidate all email lists\\\\n    cache_invalidate(\\\\\"email_list:*\\\\\", reason=\\\\\"email_sent\\\\\")\\\\n\\\\n    # Invalidate specific account\\'s folder tree\\\\n    cache_invalidate(\\\\n        \\\\\"folder_get_tree:user@example.com:*\\\\\",\\\\n        account_id=\\\\\"user@example.com\\\\\",\\\\n        reason=\\\\\"folder_created\\\\\"\\\\n    )\\\\n\\\\n    # Invalidate all cache for an account\\\\n    cache_invalidate(\\\\\"*:user@example.com:*\\\\\", reason=\\\\\"account_refresh\\\\\")\",\"inputSchema\":{\"properties\":{\"pattern\":{\"type\":\"string\"},\"account_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"reason\":{\"default\":\"manual_invalidation\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Invalidate Cache Entries\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"cache_warming_status\",\"title\":\"Get Cache Warming Status\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get cache warming status and progress (read-only, safe for unsupervised use)\\\\n\\\\nRetrieve the current status of the cache warming process, including progress,\\\\ncompletion estimates, and statistics.\\\\n\\\\nReturns:\\\\n    Dictionary containing warming status:\\\\n    - is_warming: Whether cache warming is currently active\\\\n    - started_at: When warming started (if active)\\\\n    - completed_at: When warming completed (if finished)\\\\n    - total_operations: Total number of warming operations\\\\n    - completed_operations: Number of completed operations\\\\n    - failed_operations: Number of failed operations\\\\n    - progress_percentage: Progress percentage (0-100)\\\\n    - estimated_completion: Estimated completion time\\\\n    - accounts_warmed: Number of accounts warmed\\\\n    - operations_by_type: Breakdown of operations by type\\\\n    - status: Current status message\\\\n\\\\nExample:\\\\n    status = cache_warming_status()\\\\n    if status[\\'is_warming\\']:\\\\n        print(f\\\\\"Warming in progress: {status[\\'progress_percentage\\']:.1f}%\\\\\")\\\\n    else:\\\\n        print(\\\\\"Cache warming complete or not started\\\\\")\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Cache Warming Status\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"cache\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_list_events\",\"title\":\"List Calendar Events\",\"description\":\"\\xf0\\x9f\\x93\\x96 List upcoming calendar events (read-only, safe for unsupervised use)\\\\n\\\\nReturns calendar events from now until the specified number of days ahead.\\\\n\\\\nCaching: Results are cached for 5 minutes (fresh) / 30 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    days_ahead: Number of days ahead to look for events (1-365, default: 7)\\\\n    include_details: Include full event details like attendees and body (default: False)\\\\n    limit: Maximum events to return (1-200, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of calendar events with metadata.\\\\n    Each event includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"days_ahead\":{\"default\":7,\"type\":\"integer\"},\"include_details\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Calendar Events\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_get_event\",\"title\":\"Get Calendar Event\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get full event details (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete event information including recurrence patterns and online meeting details.\\\\n\\\\nArgs:\\\\n    event_id: The event ID\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    Complete event object with all metadata\",\"inputSchema\":{\"properties\":{\"event_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"event_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Calendar Event\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_create_event\",\"title\":\"Create Calendar Event\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a calendar event (requires user confirmation recommended)\\\\n\\\\nCreates a new calendar event with optional attendees and location.\\\\nAttendees will receive meeting invitations. Addresses are validated,\\\\ndeduplicated, and limited to 500 unique recipients.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    subject: Event title\\\\n    start: Start time in ISO format (e.g., \\\\\"2024-01-15T10:00:00\\\\\")\\\\n    end: End time in ISO format\\\\n    location: Location name (optional)\\\\n    body: Event description (optional)\\\\n    attendees: Email address(es) of attendees (optional)\\\\n    timezone: Timezone for the event (default: \\\\\"UTC\\\\\")\\\\n\\\\nReturns:\\\\n    Created event object with ID\\\\n\\\\nRaises:\\\\n    ValidationError: If datetime values, timezone, or attendee\\\\n        addresses are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"subject\":{\"type\":\"string\"},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"location\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"timezone\":{\"default\":\"UTC\",\"type\":\"string\"}},\"required\":[\"account_id\",\"subject\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_update_event\",\"title\":\"Update Calendar Event\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update event properties (requires user confirmation recommended)\\\\n\\\\nModifies event details like time, location, or attendees.\\\\nAttendees will receive update notifications.\\\\n\\\\nAllowed update keys: subject, start, end, timezone, location, body, attendees.\\\\n\\\\nArgs:\\\\n    event_id: The event ID to update\\\\n    updates: Dictionary with fields to update (subject, start, end, location, body)\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated event object\",\"inputSchema\":{\"properties\":{\"event_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"event_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_delete_event\",\"title\":\"Delete Calendar Event\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a calendar event (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the event and cannot be undone.\\\\nIf this is a meeting, attendees will receive cancellation notices.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event to delete\\\\n    send_cancellation: Whether to notify attendees (default: True)\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"send_cancellation\":{\"default\":true,\"type\":\"boolean\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"event_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_respond_event\",\"title\":\"Respond to Calendar Event\",\"description\":\"\\xe2\\x9a\\xa0\\xef\\xb8\\x8f Respond to a calendar event invitation (requires user confirmation recommended)\\\\n\\\\nIMPORTANT: This sends a response to the event organizer.\\\\n\\\\nValid responses:\\\\n    - \\\\\"accept\\\\\" - Accept the invitation\\\\n    - \\\\\"decline\\\\\" - Decline the invitation\\\\n    - \\\\\"tentativelyAccept\\\\\" - Mark as tentative\\\\n  (Input is case-insensitive; \\\\\"tentative\\\\\" is accepted as an alias.)\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to respond to\\\\n    response: Response type (default: \\\\\"accept\\\\\")\\\\n    message: Optional message to the organizer\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the response value or message payload is invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"response\":{\"default\":\"accept\",\"type\":\"string\"},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"event_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Respond to Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_check_availability\",\"title\":\"Check Calendar Availability\",\"description\":\"\\xf0\\x9f\\x93\\x96 Check calendar availability for scheduling (read-only, safe for unsupervised use)\\\\n\\\\nReturns free/busy information for the user and optional attendees.\\\\nUseful for finding meeting times.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    start: Start time in ISO format\\\\n    end: End time in ISO format\\\\n    attendees: Optional email address(es) to check availability\\\\n\\\\nReturns:\\\\n    Schedule information with free/busy slots\\\\n\\\\nRaises:\\\\n    ValidationError: If start/end datetimes or attendee addresses\\\\n        are invalid.\\\\n    ValueError: If the current account email address is unavailable.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Check Calendar Availability\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_forward_event\",\"title\":\"Forward Calendar Event\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward a calendar event to recipients (always require user confirmation)\\\\n\\\\nWARNING: Meeting invitation will be sent immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    message: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"event_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Calendar Event\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_list_calendars\",\"title\":\"List Calendars\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all available calendars (read-only, safe for unsupervised use)\\\\n\\\\nReturns all calendars accessible by the user, including primary calendar\\\\nand any additional calendars (shared, group, etc.).\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of calendar objects with metadata.\\\\n    Each calendar includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Calendars\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_create_calendar\",\"title\":\"Create Calendar\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new calendar (requires user confirmation recommended)\\\\n\\\\nCreates a new calendar in the user\\'s mailbox. Useful for organizing\\\\nevents into separate calendars (work, personal, project-specific, etc.).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    name: Name for the new calendar\\\\n\\\\nReturns:\\\\n    Created calendar object with ID and metadata\\\\n\\\\nRaises:\\\\n    ValidationError: If calendar name is empty or invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Calendar\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_delete_calendar\",\"title\":\"Delete Calendar\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a calendar permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the calendar and ALL events\\\\ncontained within it. This action cannot be undone.\\\\n\\\\nNote: The default calendar cannot be deleted.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    calendar_id: The calendar ID to delete\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If confirm is False.\\\\n    ValueError: If attempting to delete the default calendar.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"calendar_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"calendar_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Calendar\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_propose_new_time\",\"title\":\"Propose New Meeting Time\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Propose a new time for a meeting (requires user confirmation recommended)\\\\n\\\\nProposes a new meeting time to the organizer. This is useful when you\\'ve\\\\nbeen invited to a meeting but the time doesn\\'t work for you.\\\\n\\\\nNote: This only works for meetings where you are an attendee, not the organizer.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    event_id: The event ID to propose new time for\\\\n    proposed_start: Proposed start time in ISO format (e.g., \\\\\"2024-01-15T10:00:00\\\\\")\\\\n    proposed_end: Proposed end time in ISO format\\\\n    message: Optional message explaining the proposed change\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If datetime values are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"event_id\":{\"type\":\"string\"},\"proposed_start\":{\"type\":\"string\"},\"proposed_end\":{\"type\":\"string\"},\"message\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"event_id\",\"proposed_start\",\"proposed_end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Propose New Meeting Time\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"calendar_get_free_busy\",\"title\":\"Get Free/Busy Times\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get simplified free/busy times for attendees (read-only, safe for unsupervised use)\\\\n\\\\nReturns a simplified view of free/busy information for specified attendees.\\\\nThis is similar to calendar_check_availability but focuses on availability\\\\nview strings rather than detailed schedule information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    attendees: Email address(es) to check availability for\\\\n    start: Start time in ISO format\\\\n    end: End time in ISO format\\\\n    time_interval: Interval in minutes for availability view (default: 30)\\\\n\\\\nReturns:\\\\n    Free/busy information with availability view strings\\\\n\\\\nRaises:\\\\n    ValidationError: If start/end datetimes or attendee addresses are invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"attendees\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"start\":{\"type\":\"string\"},\"end\":{\"type\":\"string\"},\"time_interval\":{\"default\":30,\"type\":\"integer\"}},\"required\":[\"account_id\",\"attendees\",\"start\",\"end\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Free/Busy Times\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"calendar\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_list\",\"title\":\"List Contacts\",\"description\":\"\\xf0\\x9f\\x93\\x96 List contacts (read-only, safe for unsupervised use)\\\\n\\\\nReturns contacts with names, email addresses, and phone numbers.\\\\n\\\\nCaching: Results are cached for 20 minutes (fresh) / 2 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum contacts to return (1-500, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of contact objects with metadata.\\\\n    Each contact includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Contacts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_get\",\"title\":\"Get Contact\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get contact details (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete contact information including all fields.\\\\n\\\\nCaching: Results are cached for 30 minutes (fresh) / 4 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    contact_id: The contact ID\\\\n    account_id: Microsoft account ID\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Contact details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"contact_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Contact\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_create\",\"title\":\"Create Contact\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new contact (requires user confirmation recommended)\\\\n\\\\nCreates a contact with name, email addresses, and phone numbers.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    given_name: First name (required)\\\\n    surname: Last name (optional)\\\\n    email_addresses: Email address(es) (optional)\\\\n    phone_numbers: Phone numbers dict with keys: business, home, mobile (optional)\\\\n\\\\nReturns:\\\\n    Created contact object with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"given_name\":{\"type\":\"string\"},\"surname\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"email_addresses\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"phone_numbers\":{\"anyOf\":[{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"given_name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Contact\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_update\",\"title\":\"Update Contact\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update contact information (requires user confirmation recommended)\\\\n\\\\nModifies contact fields like name, email, or phone numbers.\\\\n\\\\nAllowed update keys: givenName, surname, displayName, emailAddresses,\\\\nbusinessPhones, homePhones, mobilePhone, jobTitle, companyName, department.\\\\n\\\\nArgs:\\\\n    contact_id: The contact ID to update\\\\n    updates: Dictionary with fields to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated contact object\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"contact_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Contact\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_delete\",\"title\":\"Delete Contact\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a contact permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the contact and cannot be undone.\\\\n\\\\nArgs:\\\\n    contact_id: The contact to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"contact_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"contact_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Contact\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_create_list\",\"title\":\"Create Contact List\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new contact list (requires user confirmation recommended)\\\\n\\\\nCreates a contact folder (list) for organizing contacts into groups.\\\\nUseful for creating distribution lists, project teams, or other groupings.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    list_name: Name for the contact list/folder\\\\n\\\\nReturns:\\\\n    Created contact folder object with ID\\\\n\\\\nRaises:\\\\n    ValidationError: If list name is empty or invalid.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"list_name\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"list_name\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Contact List\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_add_to_list\",\"title\":\"Add Contact to List\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add a contact to a contact list (requires user confirmation recommended)\\\\n\\\\nAdds an existing contact to a contact folder (list). The contact is copied\\\\nto the list, so it will exist in both the original location and the list.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    contact_id: The contact ID to add\\\\n    list_id: The contact list/folder ID\\\\n\\\\nReturns:\\\\n    Copy of the contact in the new list\\\\n\\\\nRaises:\\\\n    ValueError: If contact or list is not found.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"contact_id\":{\"type\":\"string\"},\"list_id\":{\"type\":\"string\"}},\"required\":[\"account_id\",\"contact_id\",\"list_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Contact to List\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"contact_export\",\"title\":\"Export Contact\",\"description\":\"\\xf0\\x9f\\x93\\x96 Export a contact in vCard format (read-only, safe for unsupervised use)\\\\n\\\\nExports contact information in vCard format for portability and sharing.\\\\nvCard is a standard format supported by most contact management applications.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    contact_id: The contact ID to export\\\\n    format: Export format (currently only \\\\\"vcard\\\\\" is supported)\\\\n\\\\nReturns:\\\\n    Dictionary containing the vCard data and metadata\\\\n\\\\nRaises:\\\\n    ValidationError: If format is not supported.\\\\n    ValueError: If contact is not found.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"contact_id\":{\"type\":\"string\"},\"format\":{\"default\":\"vcard\",\"type\":\"string\"}},\"required\":[\"account_id\",\"contact_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Export Contact\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"contact\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_list\",\"title\":\"List Email Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List mail folders from mailbox (read-only, safe for unsupervised use)\\\\n\\\\nReturns root folders or child folders of a specific parent with metadata\\\\nincluding unread counts and child folder information.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: If None, lists root folders. If provided, lists child folders.\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n    limit: Maximum number of folders to return (1-250, default: 100)\\\\n\\\\nReturns:\\\\n    List of folder objects with: id, displayName, childFolderCount,\\\\n    unreadItemCount, totalItemCount, parentFolderId, isHidden\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"},\"limit\":{\"default\":100,\"type\":\"integer\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get\",\"title\":\"Get Email Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific mail folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete folder metadata including counts and hierarchy information.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to retrieve\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Folder object with full metadata including id, displayName,\\\\n    childFolderCount, unreadItemCount, totalItemCount\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_get_tree\",\"title\":\"Get Email Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of mail folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and their nested children.\\\\nUseful for understanding mailbox folder organization.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Root folder to start from (None = root)\\\\n    max_depth: Maximum recursion depth to prevent infinite loops (1-25, default: 10)\\\\n    include_hidden: Whether to include hidden folders (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"include_hidden\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_create\",\"title\":\"Create Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new mail folder (requires user confirmation recommended)\\\\n\\\\nCreates a new mail folder in the mailbox, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    display_name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, displayName, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If display_name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_rename\",\"title\":\"Rename Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a mail folder (requires user confirmation recommended)\\\\n\\\\nUpdates the display name of an existing mail folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_display_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new displayName\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_display_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_display_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_display_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_move\",\"title\":\"Move Email Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a mail folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a mail folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentFolderId\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_delete\",\"title\":\"Delete Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a mail folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(emails and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_mark_all_as_read\",\"title\":\"Mark All Emails in Folder as Read\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark all messages in a folder as read (requires user confirmation recommended)\\\\n\\\\nUpdates all messages in the specified folder to mark them as read.\\\\nThis operation may take time for folders with many messages.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID containing messages to mark as read\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages updated\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark All Emails in Folder as Read\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailfolders_empty\",\"title\":\"Empty Email Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete all messages in a folder (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes all messages in the folder\\\\nand cannot be undone. The folder itself remains but all messages\\\\nare permanently deleted.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to empty\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation with count of messages deleted\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Empty Email Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailfolders\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_list\",\"title\":\"List Email Rules\",\"description\":\"\\xf0\\x9f\\x93\\x96 List all inbox message rules (read-only, safe for unsupervised use)\\\\n\\\\nMessage rules automatically process incoming emails based on conditions.\\\\nRules are executed in sequence order (1, 2, 3...).\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    List of rules with: id, displayName, sequence, isEnabled, conditions, actions\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Email Rules\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_get\",\"title\":\"Get Email Rule\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get details of a specific message rule (read-only, safe for unsupervised use)\\\\n\\\\nReturns complete rule configuration including conditions, actions, and execution order.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Rule details including conditions, actions, sequence, and enabled status\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Rule\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_create\",\"title\":\"Create Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new inbox message rule to automatically process emails (requires user confirmation recommended)\\\\n\\\\nRules are executed in priority order (sequence number).\\\\n\\\\nConditions examples:\\\\n    {\\\\\"fromAddresses\\\\\": [{\\\\\"address\\\\\": \\\\\"john@example.com\\\\\"}]}\\\\n    {\\\\\"subjectContains\\\\\": [\\\\\"urgent\\\\\", \\\\\"important\\\\\"]}\\\\n    {\\\\\"senderContains\\\\\": [\\\\\"@company.com\\\\\"]}\\\\n    {\\\\\"hasAttachments\\\\\": true}\\\\n\\\\nActions examples:\\\\n    {\\\\\"moveToFolder\\\\\": \\\\\"folder_id\\\\\"}\\\\n    {\\\\\"markAsRead\\\\\": true}\\\\n    {\\\\\"forwardTo\\\\\": [{\\\\\"emailAddress\\\\\": {\\\\\"address\\\\\": \\\\\"manager@example.com\\\\\"}}]}\\\\n    {\\\\\"assignCategories\\\\\": [\\\\\"Red category\\\\\"]}\\\\n    {\\\\\"delete\\\\\": true}\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    display_name: Name for the rule (e.g., \\\\\"Move work emails to Projects\\\\\")\\\\n    conditions: Conditions that trigger the rule\\\\n    actions: Actions to perform when conditions match\\\\n    sequence: Rule execution order (lower numbers execute first, default: 1)\\\\n    is_enabled: Whether the rule is active (default: True)\\\\n    exceptions: Optional conditions that prevent rule execution\\\\n\\\\nReturns:\\\\n    Created rule with its ID and full configuration\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"display_name\":{\"type\":\"string\"},\"conditions\":{\"additionalProperties\":true,\"type\":\"object\"},\"actions\":{\"additionalProperties\":true,\"type\":\"object\"},\"sequence\":{\"default\":1,\"type\":\"integer\"},\"is_enabled\":{\"default\":true,\"type\":\"boolean\"},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"display_name\",\"conditions\",\"actions\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_update\",\"title\":\"Update Email Rule\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update an existing message rule (requires user confirmation recommended)\\\\n\\\\nModifies rule properties, conditions, actions, or execution order.\\\\nAt least one field must be provided to update.\\\\n\\\\nAllowed parameters: display_name, conditions, actions, sequence,\\\\nis_enabled, exceptions.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to update\\\\n    account_id: Microsoft account ID\\\\n    display_name: New name for the rule (optional)\\\\n    conditions: New conditions (optional)\\\\n    actions: New actions (optional)\\\\n    sequence: New execution order (optional)\\\\n    is_enabled: Enable or disable the rule (optional)\\\\n    exceptions: New exception conditions (optional)\\\\n\\\\nReturns:\\\\n    Updated rule configuration\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"display_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"conditions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"actions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null},\"sequence\":{\"anyOf\":[{\"type\":\"integer\"},{\"type\":\"null\"}],\"default\":null},\"is_enabled\":{\"anyOf\":[{\"type\":\"boolean\"},{\"type\":\"null\"}],\"default\":null},\"exceptions\":{\"anyOf\":[{\"additionalProperties\":true,\"type\":\"object\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_delete\",\"title\":\"Delete Email Rule\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a message rule permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the rule and cannot be undone.\\\\nEmails will no longer be automatically processed by this rule.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email Rule\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_top\",\"title\":\"Move Email Rule to Top\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the top of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to top means it runs before all other rules.\\\\nSets the rule\\'s sequence number to 1.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Top\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_bottom\",\"title\":\"Move Email Rule to Bottom\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule to the bottom of execution order (requires user confirmation recommended)\\\\n\\\\nRules execute in sequence order. Moving to bottom means it runs after all other rules.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule to Bottom\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_up\",\"title\":\"Move Email Rule Up\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule up one position in execution order (requires user confirmation recommended)\\\\n\\\\nIncreases the rule\\'s priority by moving it one position higher in the\\\\nexecution order. Rules at the top (sequence = 1) cannot be moved up.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Up\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"emailrules_move_down\",\"title\":\"Move Email Rule Down\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a message rule down one position in execution order (requires user confirmation recommended)\\\\n\\\\nDecreases the rule\\'s priority by moving it one position lower in the\\\\nexecution order. Rules at the bottom cannot be moved down further.\\\\n\\\\nArgs:\\\\n    rule_id: The message rule ID to move\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated rule with new sequence number\",\"inputSchema\":{\"properties\":{\"rule_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"rule_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email Rule Down\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"emailrules\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_list\",\"title\":\"List Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 List emails from a mailbox folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns recent emails with subject, sender, date, size, and attachment info.\\\\n\\\\nCaching: Results are cached for 2 minutes (fresh) / 10 minutes (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder: Folder name (inbox, sent, drafts, deleted, junk, archive)\\\\n    folder_id: Direct folder ID - takes precedence over folder name\\\\n    limit: Maximum emails to return (1-200, default: 10)\\\\n    include_body: Whether to include email body content (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of email messages with metadata and optionally body content.\\\\n    Each message includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":10,\"type\":\"integer\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get\",\"title\":\"Get Email\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get detailed information about a specific email (read-only, safe for unsupervised use)\\\\n\\\\nIncludes full headers, body content, and attachment metadata.\\\\nBody content is truncated at 50,000 characters by default.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    email_id: The email ID\\\\n    account_id: The account ID\\\\n    include_body: Whether to include the email body (default: True)\\\\n    body_max_length: Maximum characters for body content (1-500000, default: 50000)\\\\n    include_attachments: Whether to include attachment metadata (default: True)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Email details with:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"include_body\":{\"default\":true,\"type\":\"boolean\"},\"body_max_length\":{\"default\":50000,\"type\":\"integer\"},\"include_attachments\":{\"default\":true,\"type\":\"boolean\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_create_draft\",\"title\":\"Create Email Draft\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create an email draft (requires user confirmation recommended)\\\\n\\\\nCreates a draft email message that can be edited later before sending.\\\\nSupports attachments from local file paths.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n\\\\nReturns:\\\\n    Created draft message with ID\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create Email Draft\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_send\",\"title\":\"Send Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Send an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be sent immediately upon execution.\\\\nThis action cannot be undone.\\\\n\\\\nSupports multiple recipients, CC, attachments, and HTML formatting.\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    to: Recipient email address(es)\\\\n    subject: Email subject\\\\n    body: Email body (plain text)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    attachments: Local file path(s) for attachments (optional)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"subject\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"attachments\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"to\",\"subject\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Send Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_update\",\"title\":\"Update Email Properties\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Update email properties (requires user confirmation recommended)\\\\n\\\\nModifies properties like isRead status, categories, and flags without\\\\nchanging email content.\\\\n\\\\nExamples:\\\\n    email_update(email_id, {\\\\\"isRead\\\\\": True}, account_id)\\\\n    email_update(email_id, {\\\\\"categories\\\\\": [\\\\\"Important\\\\\"]}, account_id)\\\\n\\\\nAllowed update keys: isRead, categories, importance, flag, inferenceClassification.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    updates: Dictionary of properties to update\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated email object\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"updates\":{\"additionalProperties\":true,\"type\":\"object\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"updates\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update Email Properties\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_delete\",\"title\":\"Delete Email\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an email permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the email and cannot be undone.\\\\n\\\\nFor safety, consider moving items to the deleted items folder first using email_move.\\\\n\\\\nArgs:\\\\n    email_id: The email to delete\\\\n    account_id: The account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete Email\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_move\",\"title\":\"Move Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an email to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves the email to the specified folder without deleting it from the source.\\\\n\\\\nValid folder names: inbox, sent, drafts, deleted, junk, archive.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to move\\\\n    destination_folder: Folder name to move to\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"destination_folder\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"destination_folder\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply\",\"title\":\"Reply to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to the original sender.\\\\nThis action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_reply_all\",\"title\":\"Reply All to Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Reply to all recipients of an email (always require user confirmation)\\\\n\\\\nWARNING: Reply will be sent immediately to ALL recipients (original sender,\\\\nTo, and Cc recipients). This action cannot be undone.\\\\n\\\\nBody content is stripped of surrounding whitespace and must not be\\\\nempty before sending.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to reply to\\\\n    body: Reply message body (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If the reply body is empty/whitespace or confirm\\\\n        is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"body\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"body\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Reply All to Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_forward\",\"title\":\"Forward Email\",\"description\":\"\\xf0\\x9f\\x93\\xa7 Forward an email to recipients (always require user confirmation)\\\\n\\\\nWARNING: Email will be forwarded immediately to specified recipients.\\\\nThis action cannot be undone.\\\\n\\\\nAddresses are validated, deduplicated across To/CC, and limited to\\\\n500 unique recipients in total.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    email_id: The email ID to forward\\\\n    to: Recipient email address(es)\\\\n    cc: CC recipient email address(es) (optional)\\\\n    body: Optional comment/message to include with forward (plain text)\\\\n    confirm: Must be True to confirm sending (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValidationError: If recipients are invalid, exceed limits,\\\\n        or confirm is False.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"email_id\":{\"type\":\"string\"},\"to\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]},\"cc\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"body\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\",\"email_id\",\"to\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Forward Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"dangerous\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_get_attachment\",\"title\":\"Get Email Attachment\",\"description\":\"Download an email attachment to a validated local path.\\\\n\\\\nArgs:\\\\n    email_id: Microsoft Graph message identifier containing the attachment.\\\\n    attachment_id: Target attachment identifier within the message.\\\\n    save_path: Destination path for the attachment. Validated via\\\\n        `ensure_safe_path`; existing files are never overwritten.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Attachment metadata, including saved path and content size.\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"attachment_id\":{\"type\":\"string\"},\"save_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"attachment_id\",\"save_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Email Attachment\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_mark_read\",\"title\":\"Mark Email Read/Unread\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Mark an email as read or unread (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for marking emails as read/unread.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    is_read: Whether to mark as read (True) or unread (False) (default: True)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If is_read is not a boolean\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"is_read\":{\"default\":true,\"type\":\"boolean\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Mark Email Read/Unread\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_flag\",\"title\":\"Flag Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Flag or unflag an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for flagging emails.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    flag_status: Flag status - \\\\\"notFlagged\\\\\", \\\\\"flagged\\\\\", or \\\\\"complete\\\\\" (default: \\\\\"flagged\\\\\")\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or flag_status is unsupported\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"flag_status\":{\"default\":\"flagged\",\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Flag Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_add_category\",\"title\":\"Add Email Category\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Add categories to an email (requires user confirmation recommended)\\\\n\\\\nSimpler alternative to email_update for managing email categories.\\\\nThis replaces all existing categories with the specified ones.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to update\\\\n    account_id: Microsoft account ID\\\\n    categories: Category name(s) to apply (single string or list)\\\\n\\\\nReturns:\\\\n    Updated email object\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid\\\\n    ValidationError: If categories is empty or contains invalid values\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"categories\":{\"anyOf\":[{\"type\":\"string\"},{\"items\":{\"type\":\"string\"},\"type\":\"array\"}]}},\"required\":[\"email_id\",\"account_id\",\"categories\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Add Email Category\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"email_archive\",\"title\":\"Archive Email\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Archive an email (requires user confirmation recommended)\\\\n\\\\nQuick action to move an email to the Archive folder. This is a convenience\\\\nwrapper around email_move that specifically targets the archive folder.\\\\n\\\\nArgs:\\\\n    email_id: The email ID to archive\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Status confirmation with new email ID\\\\n\\\\nRaises:\\\\n    ValueError: If email_id is invalid or archive folder not found\",\"inputSchema\":{\"properties\":{\"email_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"email_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Archive Email\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"email\",\"safety_level\":\"moderate\",\"requires_confirmation\":false,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_list\",\"title\":\"List Files\",\"description\":\"\\xf0\\x9f\\x93\\x96 List files and/or folders in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nReturns items from OneDrive with names, sizes, and modification dates.\\\\n\\\\nCaching: Results are cached for 10 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Path to list from (default: \\\\\"/\\\\\")\\\\n    folder_id: Direct folder ID (takes precedence over path)\\\\n    limit: Maximum items to return (1-500, default: 50)\\\\n    type_filter: Filter by type - \\\\\"all\\\\\", \\\\\"files\\\\\", or \\\\\"folders\\\\\" (default: \\\\\"all\\\\\")\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    List of items matching the filter criteria.\\\\n    Each item includes _cache_status and _cached_at fields.\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"type_filter\":{\"default\":\"all\",\"type\":\"string\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"List Files\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_get\",\"title\":\"Get File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Download a OneDrive file to a local path (requires user confirmation recommended)\\\\n\\\\nThe download URL is supplied by Microsoft Graph (never user input) and is\\\\nvalidated against an allow-list of Microsoft domains before use. The file\\\\nis streamed to disk in configurable chunks with retry behaviour to protect\\\\nagainst transient failures. Download size and timeouts respect the\\\\nenvironment variables `MCP_FILE_DOWNLOAD_MAX_MB` and\\\\n`MCP_FILE_DOWNLOAD_TIMEOUT`.\\\\n\\\\nArgs:\\\\n    file_id: The Microsoft Graph file identifier to download.\\\\n    account_id: Microsoft account identifier associated with the file.\\\\n    download_path: Absolute path where the file will be stored locally.\\\\n        Must reside within an allowed root directory.\\\\n\\\\nReturns:\\\\n    Dictionary containing download metadata (name, size_mb, mime_type).\\\\n\\\\nRaises:\\\\n    ValidationError: If input parameters are invalid.\\\\n    RuntimeError: If all download attempts fail.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"download_path\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\",\"download_path\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_create\",\"title\":\"Create File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Upload a local file to OneDrive (requires user confirmation recommended)\\\\n\\\\nArgs:\\\\n    onedrive_path: Destination path within OneDrive (must start with \\'/\\').\\\\n    local_file_path: Absolute path to the local file to upload. Paths are\\\\n        validated via `ensure_safe_path` to prevent traversal and\\\\n        restrict uploads to trusted directories.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Metadata for the created OneDrive file.\",\"inputSchema\":{\"properties\":{\"onedrive_path\":{\"type\":\"string\"},\"local_file_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"onedrive_path\",\"local_file_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_update\",\"title\":\"Update File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Replace OneDrive file content with local file (requires user confirmation recommended)\\\\n\\\\nArgs:\\\\n    file_id: Target OneDrive file identifier to replace.\\\\n    local_file_path: Absolute path to the replacement file. Validated via\\\\n        `ensure_safe_path` to block traversal and enforce workspace roots.\\\\n    account_id: Microsoft account identifier.\\\\n\\\\nReturns:\\\\n    Updated file metadata returned by Microsoft Graph.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"local_file_path\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"local_file_path\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Update File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_delete\",\"title\":\"Delete File\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete a OneDrive file or folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the file or folder and cannot be undone.\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete File\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"critical\",\"requires_confirmation\":true,\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_copy\",\"title\":\"Copy File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Copy a file within OneDrive (requires user confirmation recommended)\\\\n\\\\nCreates a copy of a file in a specified destination folder. The copy\\\\noperation is asynchronous and may take time for large files.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to copy\\\\n    destination_folder_id: The destination folder ID\\\\n    account_id: Microsoft account ID\\\\n    new_name: Optional new name for the copied file\\\\n\\\\nReturns:\\\\n    Copy operation status with location URL to monitor progress\\\\n\\\\nRaises:\\\\n    ValueError: If file_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"new_name\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"file_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Copy File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_move\",\"title\":\"Move File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move a file to a different folder (requires user confirmation recommended)\\\\n\\\\nMoves a file to a different parent folder within OneDrive.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to move\\\\n    destination_folder_id: The destination folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated file object with new parentReference\\\\n\\\\nRaises:\\\\n    ValueError: If file_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_rename\",\"title\":\"Rename File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename a file (requires user confirmation recommended)\\\\n\\\\nUpdates the name of an existing OneDrive file.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to rename\\\\n    new_name: New name for the file\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated file object with new name\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or new_name is empty\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"new_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"new_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_share\",\"title\":\"Share File\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a sharing link for a OneDrive file (requires user confirmation recommended)\\\\n\\\\nCreates a sharing link that allows others to access the file. Permission types\\\\ncontrol what recipients can do with the file.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to share\\\\n    account_id: Microsoft account ID\\\\n    permission_type: Type of permission - \\\\\"view\\\\\" or \\\\\"edit\\\\\" (default: \\\\\"view\\\\\")\\\\n    scope: Link scope - \\\\\"anonymous\\\\\" or \\\\\"organization\\\\\" (default: \\\\\"anonymous\\\\\")\\\\n\\\\nReturns:\\\\n    Sharing link details including the web URL\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or permission_type/scope is unsupported\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"permission_type\":{\"default\":\"view\",\"type\":\"string\"},\"scope\":{\"default\":\"anonymous\",\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Share File\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"file_download_url\",\"title\":\"Get File Download URL\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get direct download URL for a OneDrive file (read-only, safe for unsupervised use)\\\\n\\\\nReturns a temporary download URL that can be used to download the file directly\\\\nwithout authentication. The URL expires after a short period.\\\\n\\\\nArgs:\\\\n    file_id: The file ID to get download URL for\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Dictionary containing the download URL and file metadata\\\\n\\\\nRaises:\\\\n    ValueError: If file_id is invalid or file not found\",\"inputSchema\":{\"properties\":{\"file_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"file_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get File Download URL\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"file\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_list\",\"title\":\"List Folders\",\"description\":\"\\xf0\\x9f\\x93\\x96 List only folders (not files) in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nReturns folders with child counts and hierarchy information.\\\\n\\\\nCaching: Results are cached for 15 minutes (fresh) / 1 hour (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Path to list folders from (e.g., \\\\\"/Documents\\\\\", default: \\\\\"/\\\\\")\\\\n    folder_id: Direct folder ID (takes precedence over path)\\\\n    limit: Maximum folders to return (1-500, default: 50)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Dictionary with:\\\\n    - folders: List of folder objects with id, name, childCount, path, parentId\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"List Folders\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_get\",\"title\":\"Get Folder\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get metadata for a specific OneDrive folder (read-only, safe for unsupervised use)\\\\n\\\\nReturns folder details including child count and web URL.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    folder_id: Folder ID (takes precedence if provided)\\\\n    path: Folder path (e.g., \\\\\"/Documents/Projects\\\\\")\\\\n\\\\nReturns:\\\\n    Folder metadata including childCount, webUrl, and parent info\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"path\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Folder\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_get_tree\",\"title\":\"Get Folder Tree\",\"description\":\"\\xf0\\x9f\\x93\\x96 Recursively build a tree of OneDrive folders (read-only, safe for unsupervised use)\\\\n\\\\nReturns a hierarchical tree structure showing all folders and nested subfolders.\\\\nUseful for understanding OneDrive folder organization.\\\\n\\\\nCaching: Results are cached for 30 minutes (fresh) / 2 hours (stale).\\\\nUse force_refresh=True to bypass cache and fetch fresh data.\\\\n\\\\nArgs:\\\\n    account_id: Microsoft account ID\\\\n    path: Starting path (default: \\\\\"/\\\\\")\\\\n    folder_id: Starting folder ID (takes precedence over path)\\\\n    max_depth: Maximum recursion depth (1-25, default: 10)\\\\n    use_cache: Whether to use cached data if available (default: True)\\\\n    force_refresh: Force refresh from API, bypassing cache (default: False)\\\\n\\\\nReturns:\\\\n    Nested tree structure with folders and their children, including:\\\\n    - _cache_status: Cache state (fresh/stale/miss)\\\\n    - _cached_at: When data was cached (ISO format)\",\"inputSchema\":{\"properties\":{\"account_id\":{\"type\":\"string\"},\"path\":{\"default\":\"/\",\"type\":\"string\"},\"folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"max_depth\":{\"default\":10,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Get Folder Tree\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_create\",\"title\":\"Create OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Create a new OneDrive folder (requires user confirmation recommended)\\\\n\\\\nCreates a new folder in OneDrive, either at the root level or\\\\nas a child of an existing folder.\\\\n\\\\nArgs:\\\\n    name: Name for the new folder\\\\n    account_id: Microsoft account ID\\\\n    parent_folder_id: Parent folder ID (None = root level)\\\\n\\\\nReturns:\\\\n    Created folder object with id, name, and other metadata\\\\n\\\\nRaises:\\\\n    ValueError: If name is empty or parent_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"parent_folder_id\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null}},\"required\":[\"name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Create OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_delete\",\"title\":\"Delete OneDrive Folder\",\"description\":\"\\xf0\\x9f\\x94\\xb4 Delete an OneDrive folder permanently (always require user confirmation)\\\\n\\\\nWARNING: This action permanently deletes the folder and all its contents\\\\n(files and subfolders) and cannot be undone.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to delete\\\\n    account_id: Microsoft account ID\\\\n    confirm: Must be True to confirm deletion (prevents accidents)\\\\n\\\\nReturns:\\\\n    Status confirmation\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or confirm is False\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"confirm\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Delete OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":true,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"critical\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_rename\",\"title\":\"Rename OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Rename an OneDrive folder (requires user confirmation recommended)\\\\n\\\\nUpdates the name of an existing OneDrive folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to rename\\\\n    new_name: New name for the folder\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new name\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id is invalid or new_name is empty\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"new_name\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"new_name\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Rename OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"folder_move\",\"title\":\"Move OneDrive Folder\",\"description\":\"\\xe2\\x9c\\x8f\\xef\\xb8\\x8f Move an OneDrive folder to a different parent (requires user confirmation recommended)\\\\n\\\\nMoves a folder to become a child of a different parent folder.\\\\n\\\\nArgs:\\\\n    folder_id: The folder ID to move\\\\n    destination_folder_id: The destination parent folder ID\\\\n    account_id: Microsoft account ID\\\\n\\\\nReturns:\\\\n    Updated folder object with new parentReference\\\\n\\\\nRaises:\\\\n    ValueError: If folder_id or destination_folder_id is invalid\",\"inputSchema\":{\"properties\":{\"folder_id\":{\"type\":\"string\"},\"destination_folder_id\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"}},\"required\":[\"folder_id\",\"destination_folder_id\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":true,\"type\":\"object\"},\"annotations\":{\"title\":\"Move OneDrive Folder\",\"readOnlyHint\":false,\"destructiveHint\":false,\"idempotentHint\":false,\"openWorldHint\":true},\"_meta\":{\"category\":\"folder\",\"safety_level\":\"moderate\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_files\",\"title\":\"Search Files\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search for files in OneDrive (read-only, safe for unsupervised use)\\\\n\\\\nSearches file names and content across all accessible OneDrive folders.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OneDrive-specific search\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching files with metadata\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Files\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_emails\",\"title\":\"Search Emails\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search emails across mailbox (read-only, safe for unsupervised use)\\\\n\\\\nSearches email subject, body, and sender across all or specific folders.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OData $search parameter\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    folder: Optional folder to search within (e.g., \\\\\"inbox\\\\\", \\\\\"sent\\\\\")\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching emails with metadata\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"folder\":{\"anyOf\":[{\"type\":\"string\"},{\"type\":\"null\"}],\"default\":null},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Emails\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_events\",\"title\":\"Search Events\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search calendar events (read-only, safe for unsupervised use)\\\\n\\\\nSearches event titles, locations, and descriptions within date range.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Uses OData $search parameter\\\\n- Work/school accounts: Uses unified search API\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    days_ahead: Days to look forward (0-730, default: 365)\\\\n    days_back: Days to look back (0-730, default: 365)\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching events\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"days_ahead\":{\"default\":365,\"type\":\"integer\"},\"days_back\":{\"default\":365,\"type\":\"integer\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Events\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_contacts\",\"title\":\"Search Contacts\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search contacts (read-only, safe for unsupervised use)\\\\n\\\\nSearches contact names, email addresses, and phone numbers.\\\\nUses $filter with prefix matching (startswith) for all account types\\\\ndue to Graph API limitations.\\\\n\\\\nNote: Contact search is limited to prefix matching and may not find\\\\nmatches in the middle of names.\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters, used as prefix)\\\\n    account_id: Microsoft account ID\\\\n    limit: Maximum results to return (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    List of matching contacts\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"properties\":{\"result\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"}},\"required\":[\"result\"],\"type\":\"object\",\"x-fastmcp-wrap-result\":true},\"annotations\":{\"title\":\"Search Contacts\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"search_unified\",\"title\":\"Unified Search\",\"description\":\"\\xf0\\x9f\\x93\\x96 Search across multiple Microsoft 365 resources (read-only, safe for unsupervised use)\\\\n\\\\nSearches emails, events, and files simultaneously.\\\\nAutomatically routes to the appropriate API based on account type:\\\\n- Personal accounts: Performs sequential searches for each entity type\\\\n- Work/school accounts: Uses unified search API for parallel search\\\\n\\\\nArgs:\\\\n    query: Search query string (1-512 characters)\\\\n    account_id: Microsoft account ID\\\\n    entity_types: Types to search: \\'message\\', \\'event\\', \\'driveItem\\' (default: all)\\\\n    limit: Maximum results per type (1-500, default: 50)\\\\n    use_cache: Whether to use cache (default: True)\\\\n    force_refresh: Bypass cache and fetch fresh data (default: False)\\\\n\\\\nReturns:\\\\n    Dictionary with results grouped by entity type\",\"inputSchema\":{\"properties\":{\"query\":{\"type\":\"string\"},\"account_id\":{\"type\":\"string\"},\"entity_types\":{\"anyOf\":[{\"items\":{\"type\":\"string\"},\"type\":\"array\"},{\"type\":\"null\"}],\"default\":null},\"limit\":{\"default\":50,\"type\":\"integer\"},\"use_cache\":{\"default\":true,\"type\":\"boolean\"},\"force_refresh\":{\"default\":false,\"type\":\"boolean\"}},\"required\":[\"query\",\"account_id\"],\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"items\":{\"additionalProperties\":true,\"type\":\"object\"},\"type\":\"array\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Unified Search\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"search\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}},{\"name\":\"server_get_version\",\"title\":\"Get Server Version\",\"description\":\"\\xf0\\x9f\\x93\\x96 Get the version of the m365-mcp server (read-only, safe for unsupervised use)\\\\n\\\\nReturns the current version of the m365-mcp server that is running.\\\\nUseful for diagnostics, troubleshooting, and ensuring compatibility.\\\\n\\\\nReturns:\\\\n    Dictionary containing:\\\\n    - version: The semantic version string (e.g., \\\\\"0.1.3\\\\\")\\\\n    - package: The package name (\\\\\"m365-mcp\\\\\")\\\\n\\\\nExample:\\\\n    >>> server_get_version()\\\\n    {\\\\\"version\\\\\": \\\\\"0.1.3\\\\\", \\\\\"package\\\\\": \\\\\"m365-mcp\\\\\"}\",\"inputSchema\":{\"properties\":{},\"type\":\"object\"},\"outputSchema\":{\"additionalProperties\":{\"type\":\"string\"},\"type\":\"object\"},\"annotations\":{\"title\":\"Get Server Version\",\"readOnlyHint\":true,\"destructiveHint\":false,\"idempotentHint\":true,\"openWorldHint\":true},\"_meta\":{\"category\":\"server\",\"safety_level\":\"safe\",\"_fastmcp\":{\"tags\":[]}}}]}}\\r\\n\\r\\n'", "module": "sse", "function": "_stream_response", "line": 179}
{"timestamp": "2025-11-19T16:52:51.363252+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
{"timestamp": "2025-11-19T16:52:51.370075+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http_manager", "message": "Session already exists, handling request directly", "module": "streamable_http_manager", "function": "_handle_stateful_request", "line": 215}
{"timestamp": "2025-11-19T16:52:51.370111+00:00", "level": "INFO", "logger": "mcp.server.streamable_http", "message": "Terminating session: df148abdfd0843a1ba56ab1d20250780", "module": "streamable_http", "function": "terminate", "line": 630}
{"timestamp": "2025-11-19T16:52:51.370342+00:00", "level": "DEBUG", "logger": "mcp.server.streamable_http", "message": "Closing standalone SSE writer", "module": "streamable_http", "function": "standalone_sse_writer", "line": 581}
{"timestamp": "2025-11-19T16:52:51.370717+00:00", "level": "DEBUG", "logger": "sse_starlette.sse", "message": "Got event: http.disconnect. Stop streaming.", "module": "sse", "function": "_listen_for_disconnect", "line": 200}
